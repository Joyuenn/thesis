Sun Oct 8 15:32:46 AEDT 2023
Sun Oct 8 15:38:12 AEDT 2023
Found cached dataset csv (/srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
Running:  /srv/scratch/z5313567/thesis/whisper/code/whisper_medium_en_finetune_AusKidTalk_scripted_lowercase.py
Started: 08/10/2023 15:38:13

------> IMPORTING PACKAGES.... ---------------------------------------

-->Importing datasets...
-->Importing random...
-->Importing pandas & numpy...
-->Importing re...
-->Importing json...
-->Importing Whisper Packages...
-->Importing soundfile...
-->Importing librosa...
-->Importing torch, dataclasses & typing...
-->Importing from transformers for training...
-->Importing pyarrow for loading dataset...
-->SUCCESS! All packages imported.

------> EXPERIMENT ARGUMENTS ----------------------------------------- 

base_fp: /srv/scratch/z5313567/thesis/
model: whisper
dataset_name: AusKidTalk
experiment_id: whisper_medium_finetune_AusKidTalk_lowercase_20231005
cache_name: AusKidTalk-finetune
training: True
use_checkpoint: True
checkpoint: /srv/scratch/z5313567/thesis/whisper/model/AusKidTalk/whisper_medium_finetune_AusKidTalk_lowercase_20231005/checkpoint-4000
use_pretrained_tokenizer: True
pretrained_tokenizer: openai/whisper-medium.en
eval_pretrained: False
baseline_model: openai/whisper-medium.en
eval_baseline: False

------> TRAINING ARGUMENTS... ----------------------------------------

learning_rate: 1e-05
per_device_train_batch_size: 8
per_device_eval_batch_size: 32
seed: 42
adam_beta1: 0.9
adam_beta2: 0.999
adam_epsilon: 1e-08
lr_scheduler_type: linear
warmup_steps: 500
max_steps: 5500
gradient_accumulation_steps: 1
gradient_checkpointing: True
fp16: True
evaluation_strategy: steps
predict_with_generate: True
generation_max_length: 225
save_steps: 1000
eval_steps: 1000
logging_steps: 500
load_best_model_at_end: True
metric_for_best_model: wer
greater_is_better: False
group_by_length: True

------> GENERATING FILEPATHS... --------------------------------------

--> data_train_fp: /srv/scratch/z5313567/thesis/AusKidTalk_local/scripted_new/AusKidTalk_scripted_train_dataframe_new_180speakers_shuffled_only_transcription_filepath.csv
--> data_dev_fp: /srv/scratch/z5313567/thesis/AusKidTalk_local/scripted_new/AusKidTalk_scripted_dev_dataframe_new_180speakers_shuffled_only_transcription_filepath.csv
--> data_test_fp: /srv/scratch/z5313567/thesis/AusKidTalk_local/scripted_new/AusKidTalk_scripted_test_dataframe_new_180speakers_shuffled_only_transcription_filepath.csv
--> data_cache_fp: /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune
--> vocab_fp: /srv/scratch/z5313567/thesis/whisper/vocab/AusKidTalk/whisper_medium_finetune_AusKidTalk_lowercase_20231005_vocab.json
--> model_fp: /srv/scratch/z5313567/thesis/whisper/model/AusKidTalk/whisper_medium_finetune_AusKidTalk_lowercase_20231005
--> baseline_results_fp: /srv/scratch/z5313567/thesis/whisper/baseline_result/AusKidTalk/whisper_medium_finetune_AusKidTalk_lowercase_20231005_baseline_result.csv
--> finetuned_results_fp: /srv/scratch/z5313567/thesis/whisper/finetuned_result/AusKidTalk/whisper_medium_finetune_AusKidTalk_lowercase_20231005_finetuned_result.csv
--> pretrained_mod: /srv/scratch/z5313567/thesis/whisper/model/AusKidTalk/whisper_medium_finetune_AusKidTalk_lowercase_20231005/checkpoint-4000
--> pretrained_tokenizer: openai/whisper-medium.en

------> PREPARING DATASET... ------------------------------------

  0%|          | 0/3 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00, 12.52it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00, 12.52it/s]
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-122d31d09aec808f.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-6982508d54ee7209.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-5235d8738bb15283.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-3d0c6adfea59db03_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-7aba651f4e97e2eb_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-798306f01848cee7_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-953b5958d8a30038_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-a1b93e8b61be3db4_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-finetune/csv/default-038a3ddb82dc47c7/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-f77bd2f1da8ba32b_*_of_00004.arrow
/srv/scratch/z5313567/thesis/whisper/code/whisper_medium_en_finetune_AusKidTalk_scripted_lowercase.py:451: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  wer_metric = load_metric("wer")
