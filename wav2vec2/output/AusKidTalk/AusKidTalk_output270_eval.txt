Mon Oct 23 11:30:18 AEDT 2023
Found cached dataset csv (/srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval/csv/default-8af5fb7ce6b38c0c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
------------------------------------------------------------------------
                 run_finetune_kids.py                                   
------------------------------------------------------------------------
Running:  /srv/scratch/z5313567/thesis/wav2vec2/code/eval_AusKidTalk_lowercase.py
Started: 23/10/2023 11:30:18

------> IMPORTING PACKAGES.... ---------------------------------------

-->Importing datasets...
-->Importing jiwer...
-->Importing random...
-->Importing pandas & numpy...
-->Importing re...
-->Importing json...
-->Importing Wav2VecCTC...
-->Importing soundfile...
-->Importing librosa...
-->Importing torch, dataclasses & typing...
-->Importing from transformers for training...
-->Importing pyarrow for loading dataset...
-->SUCCESS! All packages imported.

------> EXPERIMENT ARGUMENTS ----------------------------------------- 

base_fp: /srv/scratch/z5313567/thesis/
model: wav2vec2
dataset_name: AusKidTalk
experiment_id: eval_AusKidTalk_scripted_lowercase_20231023_2
cache_name: AusKidTalk-eval
training: False
use_checkpoint: True
checkpoint: /srv/scratch/z5313567/thesis/wav2vec2/model/CU/finetune_CU_lowercase_freeze_lower_6_transformer_layers_20231018
use_pretrained_tokenizer: True
pretrained_tokenizer: /srv/scratch/z5313567/thesis/wav2vec2/model/OGI_American/full/full_model_OGI_American_20230702
eval_pretrained: True
eval_model: /srv/scratch/z5313567/thesis/wav2vec2/model/CU/finetune_CU_lowercase_freeze_lower_6_transformer_layers_20231018
baseline_model: facebook/wav2vec2-base-960h
eval_baseline: False

------> MODEL ARGUMENTS... -------------------------------------------

hidden_dropout: 0.1
activation_dropout: 0.1
attention_dropoutput: 0.1
feat_proj_dropout: 0.0
layerdrop: 0.1
mask_time_prob: 0.05
mask_time_length: 10
ctc_loss_reduction: mean
ctc_zero_infinity: True
gradient_checkpointing: True

------> TRAINING ARGUMENTS... ----------------------------------------

evaluation strategy: steps
per_device_train_batch_size: 8
gradient_accumulation_steps: 1
learning_rate: 3e-05
weight_decay: 0.01
adam_beta1: 0.9
adam_beta2: 0.98
adam_epsilon: 1e-08
num_train_epochs: 14
max_steps: 60000
lr_scheduler_type: linear
warmup_ratio: 0.1
logging_strategy: steps
logging_steps: 1000
save_strategy: steps
save_steps: 1000
save_total_limit: 3
fp16: True
eval_steps: 1000
load_best_model_at_end: True
metric_for_best_model: wer
greater_is_better: False
group_by_length: True

------> GENERATING FILEPATHS... --------------------------------------

--> data_train_fp: /srv/scratch/z5313567/thesis/CU_local/CU_test.csv
--> data_test_fp: /srv/scratch/z5313567/thesis/AusKidTalk_local/scripted_new/AusKidTalk_scripted_test_dataframe_new_180speakers_shuffled_only_transcription_filepath.csv
--> data_cache_fp: /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval
--> data_cache_fp: /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval
--> model_cache_fp: /srv/scratch/z5313567/thesis/cache
--> vocab_fp: /srv/scratch/z5313567/thesis/wav2vec2/vocab/AusKidTalk/eval_AusKidTalk_scripted_lowercase_20231023_2_vocab.json
--> model_fp: /srv/scratch/z5313567/thesis/wav2vec2/model/AusKidTalk/eval_AusKidTalk_scripted_lowercase_20231023_2
--> baseline_results_fp: /srv/scratch/z5313567/thesis/wav2vec2/baseline_result/AusKidTalk/eval_AusKidTalk_scripted_lowercase_20231023_2_baseline_result.csv
--> baseline_alignment_results_fp: /srv/scratch/z5313567/thesis/wav2vec2/baseline_result/AusKidTalk/eval_AusKidTalk_scripted_lowercase_20231023_2_baseline_result.txt
--> finetuned_results_fp: /srv/scratch/z5313567/thesis/wav2vec2/finetuned_result/AusKidTalk/eval_AusKidTalk_scripted_lowercase_20231023_2_finetuned_result.csv
--> finetuned_alignment_results_fp: /srv/scratch/z5313567/thesis/wav2vec2/finetuned_result/AusKidTalk/eval_AusKidTalk_scripted_lowercase_20231023_2_finetuned_result.txt
--> pretrained_mod: /srv/scratch/z5313567/thesis/wav2vec2/model/CU/finetune_CU_lowercase_freeze_lower_6_transformer_layers_20231018
--> pretrained_tokenizer: /srv/scratch/z5313567/thesis/wav2vec2/model/OGI_American/full/full_model_OGI_American_20230702

------> PREPARING DATASET... ------------------------------------

  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 20.06it/s]
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval/csv/default-8af5fb7ce6b38c0c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-f8e0d2599598cb97.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval/csv/default-8af5fb7ce6b38c0c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-551530191aec6f23.arrow
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval/csv/default-8af5fb7ce6b38c0c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-834733eddb91c448_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval/csv/default-8af5fb7ce6b38c0c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-2f90fcbf6c45673f_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval/csv/default-8af5fb7ce6b38c0c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-a3be863cc9d99875_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/AusKidTalk-eval/csv/default-8af5fb7ce6b38c0c/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-5d10a0fd2e60c14a_*_of_00004.arrow
/srv/scratch/z5313567/thesis/wav2vec2/code/eval_AusKidTalk_lowercase.py:552: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  wer_metric = load_metric("wer")
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py:1643: FutureWarning: The method `freeze_feature_extractor` is deprecated and will be removed in Transformers v5.Please use the equivalent `freeze_feature_encoder` method instead.
  warnings.warn(
--> dataset...
DatasetDict({
    train: Dataset({
        features: ['filepath', 'transcription_clean'],
        num_rows: 10
    })
    test: Dataset({
        features: ['filepath', 'transcription_clean'],
        num_rows: 3968
    })
})
--> Printing some random samples...
                                            filepath                transcription_clean
0  /srv/scratch/chacmod/CU_2/corpus/data/train-pa...  BI BUBBLES BIG WHY ARE SOME SMALL
1  /srv/scratch/chacmod/CU_2/corpus/data/train-pa...  BI BUBBLES BIG WHY ARE SOME SMALL
2  /srv/scratch/chacmod/CU_2/corpus/data/train-pa...  BI BUBBLES BIG WHY ARE SOME SMALL
3  /srv/scratch/chacmod/CU_2/corpus/data/train-pa...  BI BUBBLES BIG WHY ARE SOME SMALL
4  /srv/scratch/chacmod/CU_2/corpus/data/train-pa...  BI BUBBLES BIG WHY ARE SOME SMALL
SUCCESS: Prepared dataset.

------> PROCESSING TRANSCRIPTION... ---------------------------------------


------> CREATING WAV2VEC2 FEATURE EXTRACTOR... -----------------------

SUCCESS: Created feature extractor.

------> PRE-PROCESSING DATA... ----------------------------------------- 

--> Verifying data with a random sample...
Target text: bi bubbles big why are some small
Input array shape: (46881,)
Sampling rate: 16000
SUCCESS: Data ready for training and evaluation.

------> PREPARING FOR TRAINING & EVALUATION... ----------------------- 

--> Defining data collator...
SUCCESS: Data collator defined.
--> Defining evaluation metric...
SUCCESS: Defined WER evaluation metric.
--> Loading pre-trained checkpoint...
SUCCESS: Pre-trained checkpoint loaded.

------> EVALUATING MODEL... ------------------------------------------ 

Map:   0%|          | 0/3968 [00:00<?, ? examples/s]Map:   0%|          | 1/3968 [00:01<1:27:22,  1.32s/ examples]Map:   0%|          | 7/3968 [00:01<10:15,  6.43 examples/s]  Map:   0%|          | 13/3968 [00:01<05:12, 12.67 examples/s]Map:   0%|          | 19/3968 [00:01<03:29, 18.87 examples/s]Map:   1%|          | 25/3968 [00:01<02:36, 25.25 examples/s]Map:   1%|          | 32/3968 [00:01<02:00, 32.62 examples/s]Map:   1%|          | 39/3968 [00:02<01:40, 38.98 examples/s]Map:   1%|          | 46/3968 [00:02<01:26, 45.35 examples/s]Map:   1%|▏         | 53/3968 [00:02<01:19, 49.36 examples/s]Map:   2%|▏         | 61/3968 [00:02<01:12, 53.68 examples/s]Map:   2%|▏         | 69/3968 [00:02<01:06, 58.65 examples/s]Map:   2%|▏         | 76/3968 [00:02<01:06, 58.83 examples/s]Map:   2%|▏         | 85/3968 [00:02<00:59, 65.35 examples/s]Map:   2%|▏         | 94/3968 [00:02<00:56, 68.52 examples/s]Map:   3%|▎         | 103/3968 [00:02<00:55, 69.64 examples/s]Map:   3%|▎         | 112/3968 [00:03<00:52, 73.24 examples/s]Map:   3%|▎         | 121/3968 [00:03<00:51, 75.17 examples/s]Map:   3%|▎         | 132/3968 [00:03<00:54, 71.02 examples/s]Map:   4%|▎         | 141/3968 [00:03<00:51, 74.24 examples/s]Map:   4%|▍         | 149/3968 [00:03<00:51, 73.58 examples/s]Map:   4%|▍         | 158/3968 [00:03<00:50, 76.07 examples/s]Map:   4%|▍         | 166/3968 [00:03<00:51, 73.80 examples/s]Map:   4%|▍         | 174/3968 [00:03<00:51, 72.97 examples/s]Map:   5%|▍         | 182/3968 [00:04<00:52, 72.19 examples/s]Map:   5%|▍         | 191/3968 [00:04<00:50, 74.99 examples/s]Map:   5%|▌         | 200/3968 [00:04<00:50, 75.22 examples/s]Map:   5%|▌         | 209/3968 [00:04<00:48, 77.57 examples/s]Map:   5%|▌         | 218/3968 [00:04<00:49, 76.41 examples/s]Map:   6%|▌         | 226/3968 [00:04<00:49, 75.76 examples/s]Map:   6%|▌         | 235/3968 [00:04<00:47, 78.50 examples/s]Map:   6%|▌         | 243/3968 [00:04<00:48, 76.29 examples/s]Map:   6%|▋         | 252/3968 [00:04<00:48, 77.08 examples/s]Map:   7%|▋         | 260/3968 [00:05<00:48, 77.23 examples/s]Map:   7%|▋         | 268/3968 [00:05<00:49, 74.59 examples/s]Map:   7%|▋         | 277/3968 [00:05<00:48, 76.34 examples/s]Map:   7%|▋         | 286/3968 [00:05<00:47, 77.71 examples/s]Map:   7%|▋         | 294/3968 [00:05<00:48, 75.48 examples/s]Map:   8%|▊         | 302/3968 [00:05<00:50, 72.30 examples/s]Map:   8%|▊         | 310/3968 [00:05<00:52, 70.34 examples/s]Map:   8%|▊         | 320/3968 [00:05<00:48, 75.05 examples/s]Map:   8%|▊         | 329/3968 [00:05<00:48, 75.28 examples/s]Map:   8%|▊         | 337/3968 [00:06<00:48, 74.17 examples/s]Map:   9%|▊         | 346/3968 [00:06<00:47, 75.86 examples/s]Map:   9%|▉         | 356/3968 [00:06<00:47, 76.54 examples/s]Map:   9%|▉         | 365/3968 [00:06<00:47, 76.26 examples/s]Map:   9%|▉         | 374/3968 [00:06<00:45, 78.13 examples/s]Map:  10%|▉         | 383/3968 [00:06<00:46, 77.36 examples/s]Map:  10%|▉         | 391/3968 [00:06<00:46, 76.93 examples/s]Map:  10%|█         | 399/3968 [00:06<00:46, 77.31 examples/s]Map:  10%|█         | 408/3968 [00:06<00:46, 76.54 examples/s]Map:  10%|█         | 416/3968 [00:07<00:46, 76.41 examples/s]Map:  11%|█         | 425/3968 [00:07<00:45, 77.27 examples/s]Map:  11%|█         | 433/3968 [00:07<00:47, 74.72 examples/s]Map:  11%|█         | 442/3968 [00:07<00:48, 72.67 examples/s]Map:  11%|█▏        | 451/3968 [00:07<00:46, 74.84 examples/s]Map:  12%|█▏        | 459/3968 [00:07<00:47, 73.93 examples/s]Map:  12%|█▏        | 467/3968 [00:07<00:47, 74.22 examples/s]Map:  12%|█▏        | 476/3968 [00:07<00:46, 74.95 examples/s]Map:  12%|█▏        | 486/3968 [00:08<00:44, 78.29 examples/s]Map:  12%|█▏        | 495/3968 [00:08<00:44, 78.25 examples/s]Map:  13%|█▎        | 505/3968 [00:08<00:43, 79.41 examples/s]Map:  13%|█▎        | 515/3968 [00:08<00:43, 78.56 examples/s]Map:  13%|█▎        | 524/3968 [00:08<00:43, 78.97 examples/s]Map:  13%|█▎        | 532/3968 [00:08<00:44, 77.76 examples/s]Map:  14%|█▎        | 544/3968 [00:08<00:45, 74.58 examples/s]Map:  14%|█▍        | 552/3968 [00:08<00:46, 72.75 examples/s]Map:  14%|█▍        | 561/3968 [00:08<00:45, 74.76 examples/s]Map:  14%|█▍        | 570/3968 [00:09<00:45, 75.41 examples/s]Map:  15%|█▍        | 580/3968 [00:09<00:42, 79.81 examples/s]Map:  15%|█▍        | 590/3968 [00:09<00:42, 79.14 examples/s]Map:  15%|█▌        | 599/3968 [00:09<00:42, 79.03 examples/s]Map:  15%|█▌        | 608/3968 [00:09<00:41, 81.13 examples/s]Map:  16%|█▌        | 617/3968 [00:09<00:42, 79.77 examples/s]Map:  16%|█▌        | 626/3968 [00:09<00:41, 80.26 examples/s]Map:  16%|█▌        | 638/3968 [00:10<00:48, 68.38 examples/s]Map:  16%|█▋        | 646/3968 [00:10<00:47, 69.39 examples/s]Map:  17%|█▋        | 655/3968 [00:10<00:45, 72.33 examples/s]Map:  17%|█▋        | 664/3968 [00:10<00:44, 74.58 examples/s]Map:  17%|█▋        | 674/3968 [00:10<00:42, 78.15 examples/s]Map:  17%|█▋        | 683/3968 [00:10<00:41, 78.39 examples/s]Map:  17%|█▋        | 691/3968 [00:10<00:43, 76.16 examples/s]Map:  18%|█▊        | 700/3968 [00:10<00:42, 76.52 examples/s]Map:  18%|█▊        | 709/3968 [00:10<00:42, 77.55 examples/s]Map:  18%|█▊        | 718/3968 [00:11<00:40, 80.36 examples/s]Map:  18%|█▊        | 727/3968 [00:11<00:40, 79.70 examples/s]Map:  19%|█▊        | 737/3968 [00:11<00:38, 83.57 examples/s]Map:  19%|█▉        | 746/3968 [00:11<00:38, 83.57 examples/s]Map:  19%|█▉        | 755/3968 [00:11<00:39, 81.80 examples/s]Map:  19%|█▉        | 764/3968 [00:11<00:39, 82.09 examples/s]Map:  19%|█▉        | 773/3968 [00:11<00:38, 81.99 examples/s]Map:  20%|█▉        | 782/3968 [00:11<00:39, 81.31 examples/s]Map:  20%|█▉        | 792/3968 [00:11<00:37, 84.48 examples/s]Map:  20%|██        | 801/3968 [00:12<00:39, 80.81 examples/s]Map:  20%|██        | 810/3968 [00:12<00:39, 80.70 examples/s]Map:  21%|██        | 819/3968 [00:12<00:38, 81.40 examples/s]Map:  21%|██        | 829/3968 [00:12<00:38, 81.81 examples/s]Map:  21%|██        | 839/3968 [00:12<00:37, 83.15 examples/s]Map:  21%|██▏       | 848/3968 [00:12<00:37, 83.03 examples/s]Map:  22%|██▏       | 858/3968 [00:12<00:37, 83.41 examples/s]Map:  22%|██▏       | 867/3968 [00:12<00:37, 82.65 examples/s]Map:  22%|██▏       | 876/3968 [00:12<00:38, 81.19 examples/s]Map:  22%|██▏       | 887/3968 [00:13<00:40, 75.36 examples/s]Map:  23%|██▎       | 896/3968 [00:13<00:40, 76.71 examples/s]Map:  23%|██▎       | 905/3968 [00:13<00:39, 77.49 examples/s]Map:  23%|██▎       | 913/3968 [00:13<00:39, 77.13 examples/s]Map:  23%|██▎       | 923/3968 [00:13<00:38, 78.74 examples/s]Map:  23%|██▎       | 932/3968 [00:13<00:38, 78.20 examples/s]Map:  24%|██▎       | 941/3968 [00:13<00:39, 77.35 examples/s]Map:  24%|██▍       | 951/3968 [00:13<00:37, 80.70 examples/s]Map:  24%|██▍       | 961/3968 [00:14<00:37, 80.53 examples/s]Map:  24%|██▍       | 970/3968 [00:14<00:36, 82.05 examples/s]Map:  25%|██▍       | 979/3968 [00:14<00:36, 81.68 examples/s]Map:  25%|██▍       | 990/3968 [00:14<00:38, 78.07 examples/s]Map:  25%|██▌       | 998/3968 [00:14<00:39, 75.39 examples/s]Map:  25%|██▌       | 1010/3968 [00:15<01:19, 37.05 examples/s]Map:  26%|██▌       | 1019/3968 [00:15<01:08, 43.08 examples/s]Map:  26%|██▌       | 1028/3968 [00:15<00:58, 50.08 examples/s]Map:  26%|██▌       | 1037/3968 [00:15<00:52, 55.52 examples/s]Map:  26%|██▋       | 1047/3968 [00:15<00:47, 62.08 examples/s]Map:  27%|██▋       | 1056/3968 [00:15<00:43, 66.87 examples/s]Map:  27%|██▋       | 1066/3968 [00:15<00:40, 72.22 examples/s]Map:  27%|██▋       | 1076/3968 [00:15<00:38, 75.63 examples/s]Map:  27%|██▋       | 1085/3968 [00:16<00:37, 77.53 examples/s]Map:  28%|██▊       | 1095/3968 [00:16<00:35, 81.37 examples/s]Map:  28%|██▊       | 1104/3968 [00:16<00:35, 81.60 examples/s]Map:  28%|██▊       | 1113/3968 [00:16<00:35, 80.70 examples/s]Map:  28%|██▊       | 1122/3968 [00:16<00:35, 80.15 examples/s]Map:  29%|██▊       | 1132/3968 [00:16<00:35, 80.80 examples/s]Map:  29%|██▉       | 1141/3968 [00:16<00:34, 82.44 examples/s]Map:  29%|██▉       | 1150/3968 [00:16<00:34, 82.75 examples/s]Map:  29%|██▉       | 1160/3968 [00:16<00:33, 83.97 examples/s]Map:  29%|██▉       | 1170/3968 [00:17<00:33, 84.24 examples/s]Map:  30%|██▉       | 1180/3968 [00:17<00:33, 84.18 examples/s]Map:  30%|███       | 1193/3968 [00:17<00:33, 82.40 examples/s]Map:  30%|███       | 1203/3968 [00:17<00:32, 83.92 examples/s]Map:  31%|███       | 1212/3968 [00:17<00:33, 82.76 examples/s]Map:  31%|███       | 1222/3968 [00:17<00:33, 81.70 examples/s]Map:  31%|███       | 1232/3968 [00:17<00:32, 83.95 examples/s]Map:  31%|███▏      | 1242/3968 [00:17<00:32, 83.52 examples/s]Map:  32%|███▏      | 1252/3968 [00:18<00:32, 83.22 examples/s]Map:  32%|███▏      | 1262/3968 [00:18<00:32, 84.38 examples/s]Map:  32%|███▏      | 1272/3968 [00:18<00:31, 86.33 examples/s]Map:  32%|███▏      | 1285/3968 [00:18<00:32, 81.84 examples/s]Map:  33%|███▎      | 1297/3968 [00:18<00:33, 80.43 examples/s]Map:  33%|███▎      | 1307/3968 [00:18<00:32, 81.98 examples/s]Map:  33%|███▎      | 1316/3968 [00:18<00:33, 80.33 examples/s]Map:  33%|███▎      | 1325/3968 [00:18<00:32, 80.71 examples/s]Map:  34%|███▎      | 1335/3968 [00:19<00:31, 82.33 examples/s]Map:  34%|███▍      | 1345/3968 [00:19<00:30, 84.73 examples/s]Map:  34%|███▍      | 1354/3968 [00:19<00:31, 84.06 examples/s]Map:  34%|███▍      | 1367/3968 [00:19<00:32, 80.58 examples/s]Map:  35%|███▍      | 1377/3968 [00:19<00:32, 80.08 examples/s]Map:  35%|███▍      | 1387/3968 [00:19<00:31, 81.06 examples/s]Map:  35%|███▌      | 1396/3968 [00:19<00:31, 81.91 examples/s]Map:  35%|███▌      | 1406/3968 [00:19<00:30, 84.02 examples/s]Map:  36%|███▌      | 1416/3968 [00:20<00:30, 83.37 examples/s]Map:  36%|███▌      | 1425/3968 [00:20<00:30, 82.66 examples/s]Map:  36%|███▌      | 1434/3968 [00:20<00:30, 81.86 examples/s]Map:  36%|███▋      | 1443/3968 [00:20<00:31, 81.27 examples/s]Map:  37%|███▋      | 1455/3968 [00:20<00:34, 72.25 examples/s]Map:  37%|███▋      | 1464/3968 [00:20<00:33, 74.57 examples/s]Map:  37%|███▋      | 1473/3968 [00:20<00:32, 77.12 examples/s]Map:  37%|███▋      | 1482/3968 [00:20<00:31, 77.73 examples/s]Map:  38%|███▊      | 1491/3968 [00:21<00:31, 78.68 examples/s]Map:  38%|███▊      | 1499/3968 [00:21<00:32, 75.58 examples/s]Map:  38%|███▊      | 1508/3968 [00:21<00:31, 77.64 examples/s]Map:  38%|███▊      | 1518/3968 [00:21<00:30, 80.79 examples/s]Map:  38%|███▊      | 1527/3968 [00:21<00:30, 81.29 examples/s]Map:  39%|███▊      | 1536/3968 [00:21<00:30, 80.44 examples/s]Map:  39%|███▉      | 1549/3968 [00:21<00:29, 81.11 examples/s]Map:  39%|███▉      | 1558/3968 [00:21<00:29, 82.47 examples/s]Map:  39%|███▉      | 1567/3968 [00:21<00:29, 82.05 examples/s]Map:  40%|███▉      | 1576/3968 [00:22<00:29, 81.41 examples/s]Map:  40%|███▉      | 1587/3968 [00:22<00:31, 75.02 examples/s]Map:  40%|████      | 1596/3968 [00:22<00:31, 74.33 examples/s]Map:  40%|████      | 1606/3968 [00:22<00:29, 78.89 examples/s]Map:  41%|████      | 1616/3968 [00:22<00:29, 80.90 examples/s]Map:  41%|████      | 1626/3968 [00:22<00:28, 81.15 examples/s]Map:  41%|████      | 1635/3968 [00:22<00:28, 81.84 examples/s]Map:  42%|████▏     | 1648/3968 [00:23<00:29, 79.18 examples/s]Map:  42%|████▏     | 1657/3968 [00:23<00:28, 80.63 examples/s]Map:  42%|████▏     | 1666/3968 [00:23<00:29, 79.24 examples/s]Map:  42%|████▏     | 1676/3968 [00:23<00:28, 81.23 examples/s]Map:  42%|████▏     | 1686/3968 [00:23<00:27, 82.69 examples/s]Map:  43%|████▎     | 1695/3968 [00:23<00:27, 82.50 examples/s]Map:  43%|████▎     | 1704/3968 [00:23<00:28, 80.31 examples/s]Map:  43%|████▎     | 1713/3968 [00:23<00:28, 79.23 examples/s]Map:  43%|████▎     | 1722/3968 [00:23<00:28, 79.84 examples/s]Map:  44%|████▎     | 1731/3968 [00:24<00:28, 79.77 examples/s]Map:  44%|████▍     | 1740/3968 [00:24<00:27, 79.90 examples/s]Map:  44%|████▍     | 1749/3968 [00:24<00:27, 80.18 examples/s]Map:  44%|████▍     | 1758/3968 [00:24<00:27, 81.42 examples/s]Map:  45%|████▍     | 1768/3968 [00:24<00:26, 83.01 examples/s]Map:  45%|████▍     | 1781/3968 [00:24<00:27, 80.17 examples/s]Map:  45%|████▌     | 1790/3968 [00:24<00:26, 81.13 examples/s]Map:  45%|████▌     | 1799/3968 [00:24<00:27, 79.66 examples/s]Map:  46%|████▌     | 1808/3968 [00:24<00:26, 80.36 examples/s]Map:  46%|████▌     | 1820/3968 [00:25<00:27, 79.33 examples/s]Map:  46%|████▌     | 1830/3968 [00:25<00:26, 81.47 examples/s]Map:  46%|████▋     | 1840/3968 [00:25<00:26, 79.89 examples/s]Map:  47%|████▋     | 1852/3968 [00:25<00:27, 76.90 examples/s]Map:  47%|████▋     | 1862/3968 [00:25<00:26, 80.07 examples/s]Map:  47%|████▋     | 1871/3968 [00:25<00:26, 80.21 examples/s]Map:  47%|████▋     | 1881/3968 [00:25<00:25, 81.56 examples/s]Map:  48%|████▊     | 1890/3968 [00:25<00:25, 83.09 examples/s]Map:  48%|████▊     | 1902/3968 [00:26<00:25, 80.10 examples/s]Map:  48%|████▊     | 1913/3968 [00:26<00:32, 62.46 examples/s]Map:  48%|████▊     | 1922/3968 [00:26<00:30, 66.81 examples/s]Map:  49%|████▊     | 1932/3968 [00:26<00:28, 71.46 examples/s]Map:  49%|████▉     | 1942/3968 [00:26<00:26, 75.11 examples/s]Map:  49%|████▉     | 1950/3968 [00:26<00:27, 74.10 examples/s]Map:  49%|████▉     | 1959/3968 [00:26<00:26, 75.43 examples/s]Map:  50%|████▉     | 1968/3968 [00:27<00:26, 75.71 examples/s]Map:  50%|████▉     | 1978/3968 [00:27<00:25, 78.29 examples/s]Map:  50%|█████     | 1986/3968 [00:27<00:25, 77.18 examples/s]Map:  50%|█████     | 1996/3968 [00:27<00:24, 79.99 examples/s]Map:  51%|█████     | 2005/3968 [00:28<00:53, 36.42 examples/s]Map:  51%|█████     | 2014/3968 [00:28<00:44, 43.68 examples/s]Map:  51%|█████     | 2023/3968 [00:28<00:38, 50.89 examples/s]Map:  51%|█████     | 2033/3968 [00:28<00:33, 58.30 examples/s]Map:  51%|█████▏    | 2043/3968 [00:28<00:29, 65.36 examples/s]Map:  52%|█████▏    | 2052/3968 [00:28<00:27, 69.24 examples/s]Map:  52%|█████▏    | 2062/3968 [00:28<00:25, 74.45 examples/s]Map:  52%|█████▏    | 2072/3968 [00:28<00:24, 77.63 examples/s]Map:  52%|█████▏    | 2081/3968 [00:28<00:23, 78.64 examples/s]Map:  53%|█████▎    | 2091/3968 [00:29<00:23, 80.63 examples/s]Map:  53%|█████▎    | 2101/3968 [00:29<00:22, 83.04 examples/s]Map:  53%|█████▎    | 2111/3968 [00:29<00:22, 83.17 examples/s]Map:  53%|█████▎    | 2120/3968 [00:29<00:22, 83.12 examples/s]Map:  54%|█████▎    | 2132/3968 [00:29<00:22, 80.01 examples/s]Map:  54%|█████▍    | 2141/3968 [00:29<00:22, 80.38 examples/s]Map:  54%|█████▍    | 2150/3968 [00:29<00:22, 80.69 examples/s]Map:  54%|█████▍    | 2159/3968 [00:29<00:22, 80.91 examples/s]Map:  55%|█████▍    | 2169/3968 [00:29<00:21, 83.99 examples/s]Map:  55%|█████▍    | 2178/3968 [00:30<00:21, 81.86 examples/s]Map:  55%|█████▌    | 2187/3968 [00:30<00:22, 80.83 examples/s]Map:  55%|█████▌    | 2197/3968 [00:30<00:21, 83.52 examples/s]Map:  56%|█████▌    | 2207/3968 [00:30<00:20, 84.62 examples/s]Map:  56%|█████▌    | 2217/3968 [00:30<00:20, 83.94 examples/s]Map:  56%|█████▌    | 2227/3968 [00:30<00:20, 85.84 examples/s]Map:  56%|█████▋    | 2239/3968 [00:30<00:21, 81.28 examples/s]Map:  57%|█████▋    | 2248/3968 [00:30<00:21, 81.82 examples/s]Map:  57%|█████▋    | 2257/3968 [00:31<00:20, 82.96 examples/s]Map:  57%|█████▋    | 2266/3968 [00:31<00:20, 83.18 examples/s]Map:  57%|█████▋    | 2278/3968 [00:31<00:21, 78.50 examples/s]Map:  58%|█████▊    | 2288/3968 [00:31<00:21, 79.97 examples/s]Map:  58%|█████▊    | 2297/3968 [00:31<00:20, 81.06 examples/s]Map:  58%|█████▊    | 2306/3968 [00:31<00:20, 82.04 examples/s]Map:  58%|█████▊    | 2316/3968 [00:31<00:19, 84.67 examples/s]Map:  59%|█████▊    | 2326/3968 [00:31<00:19, 82.29 examples/s]Map:  59%|█████▉    | 2336/3968 [00:31<00:19, 84.51 examples/s]Map:  59%|█████▉    | 2345/3968 [00:32<00:19, 84.41 examples/s]Map:  59%|█████▉    | 2355/3968 [00:32<00:19, 83.40 examples/s]Map:  60%|█████▉    | 2365/3968 [00:32<00:18, 85.18 examples/s]Map:  60%|█████▉    | 2374/3968 [00:32<00:19, 82.51 examples/s]Map:  60%|██████    | 2384/3968 [00:32<00:19, 82.98 examples/s]Map:  60%|██████    | 2394/3968 [00:32<00:18, 82.98 examples/s]Map:  61%|██████    | 2403/3968 [00:32<00:18, 83.22 examples/s]Map:  61%|██████    | 2412/3968 [00:32<00:18, 82.86 examples/s]Map:  61%|██████    | 2422/3968 [00:33<00:18, 83.14 examples/s]Map:  61%|██████▏   | 2431/3968 [00:33<00:18, 83.03 examples/s]Map:  61%|██████▏   | 2440/3968 [00:33<00:18, 82.89 examples/s]Map:  62%|██████▏   | 2450/3968 [00:33<00:18, 83.26 examples/s]Map:  62%|██████▏   | 2460/3968 [00:33<00:17, 84.04 examples/s]Map:  62%|██████▏   | 2469/3968 [00:33<00:18, 82.59 examples/s]Map:  62%|██████▏   | 2478/3968 [00:33<00:18, 81.79 examples/s]Map:  63%|██████▎   | 2488/3968 [00:33<00:18, 81.85 examples/s]Map:  63%|██████▎   | 2498/3968 [00:33<00:17, 82.92 examples/s]Map:  63%|██████▎   | 2508/3968 [00:34<00:17, 84.40 examples/s]Map:  64%|██████▎   | 2521/3968 [00:34<00:17, 81.78 examples/s]Map:  64%|██████▍   | 2530/3968 [00:34<00:17, 82.69 examples/s]Map:  64%|██████▍   | 2539/3968 [00:34<00:17, 82.12 examples/s]Map:  64%|██████▍   | 2548/3968 [00:34<00:17, 82.21 examples/s]Map:  64%|██████▍   | 2558/3968 [00:34<00:16, 84.63 examples/s]Map:  65%|██████▍   | 2568/3968 [00:34<00:16, 86.40 examples/s]Map:  65%|██████▍   | 2578/3968 [00:34<00:16, 86.47 examples/s]Map:  65%|██████▌   | 2588/3968 [00:35<00:16, 86.03 examples/s]Map:  65%|██████▌   | 2597/3968 [00:35<00:16, 84.20 examples/s]Map:  66%|██████▌   | 2606/3968 [00:35<00:16, 81.14 examples/s]Map:  66%|██████▌   | 2616/3968 [00:35<00:16, 83.25 examples/s]Map:  66%|██████▋   | 2629/3968 [00:35<00:16, 80.93 examples/s]Map:  67%|██████▋   | 2639/3968 [00:35<00:15, 83.76 examples/s]Map:  67%|██████▋   | 2648/3968 [00:35<00:15, 83.87 examples/s]Map:  67%|██████▋   | 2658/3968 [00:35<00:15, 85.45 examples/s]Map:  67%|██████▋   | 2671/3968 [00:36<00:15, 82.15 examples/s]Map:  68%|██████▊   | 2681/3968 [00:36<00:15, 83.55 examples/s]Map:  68%|██████▊   | 2694/3968 [00:36<00:15, 82.39 examples/s]Map:  68%|██████▊   | 2704/3968 [00:36<00:15, 83.90 examples/s]Map:  68%|██████▊   | 2714/3968 [00:36<00:14, 85.31 examples/s]Map:  69%|██████▊   | 2723/3968 [00:36<00:14, 85.27 examples/s]Map:  69%|██████▉   | 2736/3968 [00:36<00:14, 84.99 examples/s]Map:  69%|██████▉   | 2745/3968 [00:36<00:14, 83.37 examples/s]Map:  69%|██████▉   | 2755/3968 [00:37<00:14, 84.17 examples/s]Map:  70%|██████▉   | 2765/3968 [00:37<00:13, 86.60 examples/s]Map:  70%|██████▉   | 2775/3968 [00:37<00:14, 83.89 examples/s]Map:  70%|███████   | 2785/3968 [00:37<00:13, 85.10 examples/s]Map:  70%|███████   | 2794/3968 [00:37<00:13, 84.49 examples/s]Map:  71%|███████   | 2803/3968 [00:37<00:14, 82.52 examples/s]Map:  71%|███████   | 2812/3968 [00:37<00:14, 82.10 examples/s]Map:  71%|███████   | 2821/3968 [00:37<00:14, 80.50 examples/s]Map:  71%|███████▏  | 2831/3968 [00:37<00:13, 83.30 examples/s]Map:  72%|███████▏  | 2840/3968 [00:38<00:13, 81.17 examples/s]Map:  72%|███████▏  | 2850/3968 [00:38<00:13, 83.55 examples/s]Map:  72%|███████▏  | 2859/3968 [00:38<00:13, 83.82 examples/s]Map:  72%|███████▏  | 2868/3968 [00:38<00:13, 83.82 examples/s]Map:  73%|███████▎  | 2878/3968 [00:38<00:13, 83.81 examples/s]Map:  73%|███████▎  | 2887/3968 [00:38<00:12, 84.14 examples/s]Map:  73%|███████▎  | 2897/3968 [00:38<00:12, 85.04 examples/s]Map:  73%|███████▎  | 2906/3968 [00:38<00:12, 85.13 examples/s]Map:  73%|███████▎  | 2915/3968 [00:38<00:12, 84.23 examples/s]Map:  74%|███████▎  | 2925/3968 [00:39<00:12, 85.51 examples/s]Map:  74%|███████▍  | 2934/3968 [00:39<00:12, 83.24 examples/s]Map:  74%|███████▍  | 2943/3968 [00:39<00:12, 82.90 examples/s]Map:  74%|███████▍  | 2952/3968 [00:39<00:12, 82.00 examples/s]Map:  75%|███████▍  | 2961/3968 [00:39<00:12, 82.43 examples/s]Map:  75%|███████▍  | 2970/3968 [00:39<00:12, 81.79 examples/s]Map:  75%|███████▌  | 2979/3968 [00:39<00:12, 82.26 examples/s]Map:  75%|███████▌  | 2989/3968 [00:39<00:11, 84.76 examples/s]Map:  76%|███████▌  | 2999/3968 [00:39<00:11, 84.93 examples/s]Map:  76%|███████▌  | 3009/3968 [00:40<00:25, 37.31 examples/s]Map:  76%|███████▌  | 3019/3968 [00:40<00:21, 44.89 examples/s]Map:  76%|███████▋  | 3028/3968 [00:40<00:18, 51.80 examples/s]Map:  77%|███████▋  | 3038/3968 [00:40<00:15, 59.35 examples/s]Map:  77%|███████▋  | 3048/3968 [00:40<00:13, 66.39 examples/s]Map:  77%|███████▋  | 3058/3968 [00:41<00:12, 70.77 examples/s]Map:  77%|███████▋  | 3068/3968 [00:41<00:11, 75.56 examples/s]Map:  78%|███████▊  | 3078/3968 [00:41<00:11, 78.92 examples/s]Map:  78%|███████▊  | 3088/3968 [00:41<00:10, 81.90 examples/s]Map:  78%|███████▊  | 3098/3968 [00:41<00:10, 83.96 examples/s]Map:  78%|███████▊  | 3108/3968 [00:41<00:10, 85.04 examples/s]Map:  79%|███████▊  | 3117/3968 [00:41<00:10, 82.68 examples/s]Map:  79%|███████▉  | 3127/3968 [00:41<00:09, 84.97 examples/s]Map:  79%|███████▉  | 3137/3968 [00:42<00:09, 85.94 examples/s]Map:  79%|███████▉  | 3149/3968 [00:42<00:09, 82.02 examples/s]Map:  80%|███████▉  | 3159/3968 [00:42<00:09, 84.69 examples/s]Map:  80%|███████▉  | 3169/3968 [00:42<00:09, 85.85 examples/s]Map:  80%|████████  | 3178/3968 [00:42<00:09, 84.28 examples/s]Map:  80%|████████  | 3188/3968 [00:42<00:09, 85.30 examples/s]Map:  81%|████████  | 3198/3968 [00:42<00:08, 86.44 examples/s]Map:  81%|████████  | 3208/3968 [00:42<00:08, 84.82 examples/s]Map:  81%|████████  | 3218/3968 [00:42<00:08, 86.17 examples/s]Map:  81%|████████▏ | 3227/3968 [00:43<00:08, 86.28 examples/s]Map:  82%|████████▏ | 3237/3968 [00:43<00:08, 83.70 examples/s]Map:  82%|████████▏ | 3246/3968 [00:43<00:08, 83.47 examples/s]Map:  82%|████████▏ | 3256/3968 [00:43<00:08, 86.12 examples/s]Map:  82%|████████▏ | 3265/3968 [00:43<00:08, 85.41 examples/s]Map:  83%|████████▎ | 3276/3968 [00:43<00:08, 78.08 examples/s]Map:  83%|████████▎ | 3285/3968 [00:43<00:08, 77.64 examples/s]Map:  83%|████████▎ | 3294/3968 [00:43<00:08, 79.32 examples/s]Map:  83%|████████▎ | 3304/3968 [00:44<00:08, 81.02 examples/s]Map:  83%|████████▎ | 3313/3968 [00:44<00:08, 79.59 examples/s]Map:  84%|████████▎ | 3323/3968 [00:44<00:07, 80.89 examples/s]Map:  84%|████████▍ | 3333/3968 [00:44<00:07, 83.53 examples/s]Map:  84%|████████▍ | 3343/3968 [00:44<00:07, 86.07 examples/s]Map:  84%|████████▍ | 3352/3968 [00:44<00:07, 85.57 examples/s]Map:  85%|████████▍ | 3362/3968 [00:44<00:07, 86.14 examples/s]Map:  85%|████████▍ | 3372/3968 [00:44<00:07, 85.04 examples/s]Map:  85%|████████▌ | 3384/3968 [00:44<00:07, 81.04 examples/s]Map:  86%|████████▌ | 3393/3968 [00:45<00:06, 82.19 examples/s]Map:  86%|████████▌ | 3403/3968 [00:45<00:06, 83.60 examples/s]Map:  86%|████████▌ | 3415/3968 [00:45<00:06, 79.16 examples/s]Map:  86%|████████▋ | 3427/3968 [00:45<00:07, 76.67 examples/s]Map:  87%|████████▋ | 3437/3968 [00:45<00:06, 78.51 examples/s]Map:  87%|████████▋ | 3447/3968 [00:45<00:06, 79.74 examples/s]Map:  87%|████████▋ | 3459/3968 [00:45<00:06, 77.15 examples/s]Map:  87%|████████▋ | 3469/3968 [00:46<00:06, 80.07 examples/s]Map:  88%|████████▊ | 3479/3968 [00:46<00:05, 81.53 examples/s]Map:  88%|████████▊ | 3489/3968 [00:46<00:05, 83.51 examples/s]Map:  88%|████████▊ | 3498/3968 [00:46<00:05, 83.17 examples/s]Map:  88%|████████▊ | 3508/3968 [00:46<00:05, 84.50 examples/s]Map:  89%|████████▊ | 3518/3968 [00:46<00:05, 84.82 examples/s]Map:  89%|████████▉ | 3527/3968 [00:46<00:05, 83.61 examples/s]Map:  89%|████████▉ | 3537/3968 [00:46<00:05, 85.90 examples/s]Map:  89%|████████▉ | 3546/3968 [00:46<00:05, 82.98 examples/s]Map:  90%|████████▉ | 3556/3968 [00:47<00:04, 84.96 examples/s]Map:  90%|████████▉ | 3566/3968 [00:47<00:04, 84.82 examples/s]Map:  90%|█████████ | 3576/3968 [00:47<00:04, 84.66 examples/s]Map:  90%|█████████ | 3586/3968 [00:47<00:04, 86.20 examples/s]Map:  91%|█████████ | 3596/3968 [00:47<00:04, 88.49 examples/s]Map:  91%|█████████ | 3606/3968 [00:47<00:04, 87.38 examples/s]Map:  91%|█████████ | 3616/3968 [00:47<00:03, 88.87 examples/s]Map:  91%|█████████▏| 3626/3968 [00:47<00:03, 88.16 examples/s]Map:  92%|█████████▏| 3635/3968 [00:47<00:03, 85.92 examples/s]Map:  92%|█████████▏| 3648/3968 [00:48<00:03, 83.37 examples/s]Map:  92%|█████████▏| 3658/3968 [00:48<00:03, 85.43 examples/s]Map:  92%|█████████▏| 3668/3968 [00:48<00:03, 85.97 examples/s]Map:  93%|█████████▎| 3677/3968 [00:48<00:03, 83.73 examples/s]Map:  93%|█████████▎| 3689/3968 [00:48<00:03, 80.63 examples/s]Map:  93%|█████████▎| 3699/3968 [00:48<00:03, 82.53 examples/s]Map:  93%|█████████▎| 3708/3968 [00:48<00:03, 83.44 examples/s]Map:  94%|█████████▎| 3718/3968 [00:48<00:02, 85.12 examples/s]Map:  94%|█████████▍| 3728/3968 [00:49<00:02, 84.41 examples/s]Map:  94%|█████████▍| 3738/3968 [00:49<00:02, 84.29 examples/s]Map:  94%|█████████▍| 3747/3968 [00:49<00:02, 84.13 examples/s]Map:  95%|█████████▍| 3756/3968 [00:49<00:02, 83.02 examples/s]Map:  95%|█████████▍| 3765/3968 [00:49<00:02, 83.56 examples/s]Map:  95%|█████████▌| 3775/3968 [00:49<00:02, 86.34 examples/s]Map:  95%|█████████▌| 3785/3968 [00:49<00:02, 88.15 examples/s]Map:  96%|█████████▌| 3794/3968 [00:49<00:02, 85.04 examples/s]Map:  96%|█████████▌| 3807/3968 [00:50<00:01, 83.03 examples/s]Map:  96%|█████████▋| 3820/3968 [00:50<00:01, 82.10 examples/s]Map:  96%|█████████▋| 3829/3968 [00:50<00:01, 81.60 examples/s]Map:  97%|█████████▋| 3838/3968 [00:50<00:01, 81.61 examples/s]Map:  97%|█████████▋| 3847/3968 [00:50<00:01, 82.51 examples/s]Map:  97%|█████████▋| 3860/3968 [00:50<00:01, 81.74 examples/s]Map:  98%|█████████▊| 3870/3968 [00:50<00:01, 83.58 examples/s]Map:  98%|█████████▊| 3879/3968 [00:50<00:01, 82.99 examples/s]Map:  98%|█████████▊| 3888/3968 [00:51<00:00, 82.59 examples/s]Map:  98%|█████████▊| 3898/3968 [00:51<00:00, 83.72 examples/s]Map:  98%|█████████▊| 3908/3968 [00:51<00:00, 85.84 examples/s]Map:  99%|█████████▊| 3917/3968 [00:51<00:00, 83.42 examples/s]Map:  99%|█████████▉| 3926/3968 [00:51<00:00, 82.46 examples/s]Map:  99%|█████████▉| 3936/3968 [00:51<00:00, 84.34 examples/s]Map:  99%|█████████▉| 3945/3968 [00:51<00:00, 84.85 examples/s]Map: 100%|█████████▉| 3958/3968 [00:51<00:00, 80.64 examples/s]Map: 100%|██████████| 3968/3968 [00:51<00:00, 82.46 examples/s]                                                               Saved results to: /srv/scratch/z5313567/thesis/wav2vec2/finetuned_result/AusKidTalk/eval_AusKidTalk_scripted_lowercase_20231023_2_finetuned_result.csv
--> Getting fine-tuned test results...
Fine-tuned Test WER: 0.859
Fine-tuned Test CER: 0.443


--> Getting finetuned alignment output...
Saved Alignment output to: /srv/scratch/z5313567/thesis/wav2vec2/finetuned_result/AusKidTalk/eval_AusKidTalk_scripted_lowercase_20231023_2_finetuned_result.txt


--> Showing some fine-tuned prediction errors...
  target_text  pred_str
0     breathe    brathe
1      carpet      copp
2   australia  ustralia
3        pull       pul
4    cucumber      puab
5       swing     swing
6     feather   feather
7      garden   guarden
8      carpet    carper
9       chair        sa
--> Taking a deeper look...
[PAD] [PAD] [PAD] [PAD] b [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] i i r r d [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD] [PAD]

------> SUCCESSFULLY FINISHED ---------------------------------------- 

Finished: 23/10/2023 11:31:33
