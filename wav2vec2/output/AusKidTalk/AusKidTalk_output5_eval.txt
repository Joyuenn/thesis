Wed Jul 5 19:33:56 AEST 2023
Found cached dataset csv (/srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
------------------------------------------------------------------------
                 run_finetune_kids.py                                   
------------------------------------------------------------------------
Running:  /srv/scratch/z5313567/thesis/wav2vec2/code/eval_AusKidTalk.py
Started: 05/07/2023 19:33:56

------> IMPORTING PACKAGES.... ---------------------------------------

-->Importing datasets...
-->Importing random...
-->Importing pandas & numpy...
-->Importing re...
-->Importing json...
-->Importing Wav2VecCTC...
-->Importing soundfile...
-->Importing librosa...
-->Importing torch, dataclasses & typing...
-->Importing from transformers for training...
-->Importing pyarrow for loading dataset...
-->SUCCESS! All packages imported.

------> EXPERIMENT ARGUMENTS ----------------------------------------- 

training: False
base_fp: /srv/scratch/z5313567/thesis/
model: wav2vec2
dataset_name: AusKidTalk
experiment_id: eval_20230705
cache_name: OGI-eval
use_checkpoint: True
checkpoint: /srv/scratch/z5313567/thesis/wav2vec2/model/OGI_American/finetune_full_20230704_3
use_pretrained_tokenizer: True
pretrained_tokenizer: facebook/wav2vec2-base-960h
eval_pretrained: True
eval_model: /srv/scratch/z5313567/thesis/wav2vec2/model/OGI_American/finetune_full_20230704_3
baseline_model: facebook/wav2vec2-base-960h
eval_baseline: False

------> MODEL ARGUMENTS... -------------------------------------------

hidden_dropout: 0.1
activation_dropout: 0.1
attention_dropoutput: 0.1
feat_proj_dropout: 0.0
layerdrop: 0.1
mask_time_prob: 0.05
mask_time_length: 10
ctc_loss_reduction: mean
ctc_zero_infinity: True
gradient_checkpointing: True

------> TRAINING ARGUMENTS... ----------------------------------------

evaluation strategy: steps
per_device_train_batch_size: 8
gradient_accumulation_steps: 1
learning_rate: 3e-05
weight_decay: 0.01
adam_beta1: 0.9
adam_beta2: 0.98
adam_epsilon: 1e-08
num_train_epochs: 14
max_steps: 60000
lr_scheduler_type: linear
warmup_ratio: 0.1
logging_strategy: steps
logging_steps: 1000
save_strategy: steps
save_steps: 1000
save_total_limit: 3
fp16: True
eval_steps: 1000
load_best_model_at_end: True
metric_for_best_model: wer
greater_is_better: False
group_by_length: True

------> GENERATING FILEPATHS... --------------------------------------

--> data_train_fp: /srv/scratch/z5313567/thesis/AusKidTalk_local/AusKidTalk_df_only_transcription_filepath.csv
--> data_test_fp: /srv/scratch/z5313567/thesis/AusKidTalk_local/AusKidTalk_df_only_transcription_filepath.csv
--> data_cache_fp: /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk
--> model_fp: /srv/scratch/z5313567/thesis/wav2vec2/model/Renee_myST_OGI_TLT/20211016_2-base-myST-OGI-TLT17
--> vocab_fp: /srv/scratch/z5313567/thesis/wav2vec2/vocab/AusKidTalk/vocab_AusKidTalk_20230704.json
--> baseline_results_fp: /srv/scratch/z5313567/thesis/wav2vec2/baseline_result/AusKidTalk/baseline_result_AusKidTalk_20230704.csv
--> finetuned_results_fp: /srv/scratch/z5313567/thesis/wav2vec2/finetuned_result/AusKidTalk/finetuned_result_AusKidTalk_20230704.csv
--> pretrained_mod: /srv/scratch/z5313567/thesis/wav2vec2/model/OGI_American/finetune_full_20230704_3
--> pretrained_tokenizer: facebook/wav2vec2-base-960h

------> PREPARING DATASET... ------------------------------------

  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 43.17it/s]
--> dataset...
DatasetDict({
    train: Dataset({
        features: ['filepath', 'transcription_clean'],
        num_rows: 3643
    })
    test: Dataset({
        features: ['filepath', 'transcription_clean'],
        num_rows: 3643
    })
})
--> Printing some random samples...
                                            filepath transcription_clean
0  /srv/scratch/chacmod/auskidtalk_audio/135_task...                nine
1  /srv/scratch/chacmod/auskidtalk_audio/1075_tas...                   i
2  /srv/scratch/chacmod/auskidtalk_audio/172_task...               mouth
3  /srv/scratch/chacmod/auskidtalk_audio/172_task...               sorry
4  /srv/scratch/chacmod/auskidtalk_audio/1075_tas...                 one
SUCCESS: Prepared dataset.

------> PROCESSING TRANSCRIPTION... ---------------------------------------

Map:   0%|          | 0/3643 [00:00<?, ? examples/s]Map:  27%|██▋       | 1000/3643 [00:00<00:00, 8058.28 examples/s]                                                                 Map:   0%|          | 0/3643 [00:00<?, ? examples/s]Map:  72%|███████▏  | 2641/3643 [00:00<00:00, 26276.90 examples/s]                                                                  
------> CREATING WAV2VEC2 FEATURE EXTRACTOR... -----------------------

SUCCESS: Created feature extractor.

------> PRE-PROCESSING DATA... ----------------------------------------- 

Map (num_proc=4):   0%|          | 0/3643 [00:00<?, ? examples/s]Map (num_proc=4):   0%|          | 1/3643 [00:02<2:04:03,  2.04s/ examples]Map (num_proc=4):   0%|          | 18/3643 [00:02<05:13, 11.55 examples/s] Map (num_proc=4):   1%|          | 45/3643 [00:02<01:47, 33.44 examples/s]Map (num_proc=4):   3%|▎         | 92/3643 [00:02<00:44, 80.09 examples/s]Map (num_proc=4):   4%|▍         | 152/3643 [00:02<00:23, 146.68 examples/s]Map (num_proc=4):   6%|▌         | 222/3643 [00:02<00:14, 232.42 examples/s]Map (num_proc=4):   8%|▊         | 294/3643 [00:02<00:10, 319.38 examples/s]Map (num_proc=4):  10%|█         | 367/3643 [00:02<00:08, 397.05 examples/s]Map (num_proc=4):  12%|█▏        | 430/3643 [00:02<00:07, 433.98 examples/s]Map (num_proc=4):  13%|█▎        | 490/3643 [00:03<00:06, 467.62 examples/s]Map (num_proc=4):  15%|█▌        | 550/3643 [00:03<00:06, 488.79 examples/s]Map (num_proc=4):  17%|█▋        | 609/3643 [00:03<00:05, 508.62 examples/s]Map (num_proc=4):  18%|█▊        | 671/3643 [00:03<00:05, 525.38 examples/s]Map (num_proc=4):  20%|██        | 743/3643 [00:03<00:05, 572.58 examples/s]Map (num_proc=4):  22%|██▏       | 819/3643 [00:03<00:04, 613.60 examples/s]Map (num_proc=4):  24%|██▍       | 889/3643 [00:03<00:04, 632.21 examples/s]Map (num_proc=4):  27%|██▋       | 972/3643 [00:03<00:04, 665.74 examples/s]Map (num_proc=4):  29%|██▊       | 1041/3643 [00:03<00:03, 657.94 examples/s]Map (num_proc=4):  31%|███       | 1112/3643 [00:03<00:03, 644.16 examples/s]Map (num_proc=4):  32%|███▏      | 1182/3643 [00:04<00:03, 638.31 examples/s]Map (num_proc=4):  35%|███▍      | 1265/3643 [00:04<00:03, 678.74 examples/s]Map (num_proc=4):  37%|███▋      | 1351/3643 [00:04<00:03, 684.03 examples/s]Map (num_proc=4):  39%|███▉      | 1427/3643 [00:04<00:03, 673.64 examples/s]Map (num_proc=4):  41%|████      | 1499/3643 [00:04<00:03, 677.98 examples/s]Map (num_proc=4):  43%|████▎     | 1581/3643 [00:04<00:02, 710.33 examples/s]Map (num_proc=4):  45%|████▌     | 1657/3643 [00:04<00:02, 696.01 examples/s]Map (num_proc=4):  48%|████▊     | 1733/3643 [00:04<00:02, 677.25 examples/s]Map (num_proc=4):  50%|████▉     | 1819/3643 [00:04<00:02, 699.77 examples/s]Map (num_proc=4):  52%|█████▏    | 1895/3643 [00:05<00:02, 701.49 examples/s]Map (num_proc=4):  54%|█████▍    | 1974/3643 [00:05<00:02, 724.08 examples/s]Map (num_proc=4):  56%|█████▋    | 2053/3643 [00:05<00:02, 686.56 examples/s]Map (num_proc=4):  58%|█████▊    | 2128/3643 [00:05<00:02, 690.70 examples/s]Map (num_proc=4):  61%|██████    | 2207/3643 [00:05<00:02, 705.65 examples/s]Map (num_proc=4):  63%|██████▎   | 2280/3643 [00:05<00:01, 696.78 examples/s]Map (num_proc=4):  65%|██████▍   | 2358/3643 [00:05<00:01, 663.74 examples/s]Map (num_proc=4):  67%|██████▋   | 2429/3643 [00:05<00:01, 623.26 examples/s]Map (num_proc=4):  68%|██████▊   | 2493/3643 [00:06<00:01, 625.23 examples/s]Map (num_proc=4):  70%|███████   | 2564/3643 [00:06<00:01, 639.36 examples/s]Map (num_proc=4):  72%|███████▏  | 2636/3643 [00:06<00:01, 655.21 examples/s]Map (num_proc=4):  74%|███████▍  | 2703/3643 [00:06<00:01, 583.44 examples/s]Map (num_proc=4):  76%|███████▌  | 2770/3643 [00:06<00:01, 604.34 examples/s]Map (num_proc=4):  78%|███████▊  | 2840/3643 [00:06<00:01, 625.34 examples/s]Map (num_proc=4):  80%|████████  | 2925/3643 [00:06<00:01, 681.12 examples/s]Map (num_proc=4):  83%|████████▎ | 3011/3643 [00:06<00:00, 722.68 examples/s]Map (num_proc=4):  85%|████████▍ | 3092/3643 [00:06<00:00, 701.59 examples/s]Map (num_proc=4):  87%|████████▋ | 3176/3643 [00:07<00:00, 712.69 examples/s]Map (num_proc=4):  89%|████████▉ | 3255/3643 [00:07<00:00, 684.57 examples/s]Map (num_proc=4):  91%|█████████▏| 3331/3643 [00:07<00:00, 602.45 examples/s]Map (num_proc=4):  93%|█████████▎| 3404/3643 [00:07<00:00, 623.10 examples/s]Map (num_proc=4):  95%|█████████▌| 3473/3643 [00:07<00:00, 614.21 examples/s]Map (num_proc=4):  97%|█████████▋| 3538/3643 [00:07<00:00, 559.26 examples/s]Map (num_proc=4):  99%|█████████▊| 3597/3643 [00:07<00:00, 437.00 examples/s]                                                                             Map (num_proc=4):   0%|          | 0/3643 [00:00<?, ? examples/s]Map (num_proc=4):   0%|          | 1/3643 [00:01<1:26:11,  1.42s/ examples]Map (num_proc=4):   5%|▍         | 173/3643 [00:01<00:22, 157.65 examples/s]Map (num_proc=4):  12%|█▏        | 454/3643 [00:01<00:06, 463.51 examples/s]Map (num_proc=4):  20%|██        | 730/3643 [00:01<00:03, 787.41 examples/s]Map (num_proc=4):  28%|██▊       | 1013/3643 [00:01<00:02, 1128.20 examples/s]Map (num_proc=4):  36%|███▌      | 1306/3643 [00:01<00:01, 1473.68 examples/s]Map (num_proc=4):  44%|████▍     | 1599/3643 [00:02<00:01, 1780.73 examples/s]Map (num_proc=4):  52%|█████▏    | 1890/3643 [00:02<00:00, 2042.68 examples/s]Map (num_proc=4):  60%|█████▉    | 2184/3643 [00:02<00:00, 2263.35 examples/s]Map (num_proc=4):  68%|██████▊   | 2464/3643 [00:02<00:00, 2395.40 examples/s]Map (num_proc=4):  76%|███████▌  | 2772/3643 [00:02<00:00, 2545.50 examples/s]Map (num_proc=4):  84%|████████▍ | 3055/3643 [00:02<00:00, 2615.23 examples/s]Map (num_proc=4):  92%|█████████▏| 3345/3643 [00:02<00:00, 2684.47 examples/s]Map (num_proc=4): 100%|██████████| 3643/3643 [00:02<00:00, 1763.98 examples/s]                                                                              --> Verifying data with a random sample...
Target text: THREE
Input array shape: (5760,)
Sampling rate: 16000
Map (num_proc=4):   0%|          | 0/3643 [00:00<?, ? examples/s]/home/z5313567/.local/lib/python3.10/site-packages/transformers/feature_extraction_utils.py:166: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  tensor = as_tensor(value)
/home/z5313567/.local/lib/python3.10/site-packages/transformers/feature_extraction_utils.py:166: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  tensor = as_tensor(value)
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/processing_wav2vec2.py:155: UserWarning: `as_target_processor` is deprecated and will be removed in v5 of Transformers. You can process your labels by using the argument `text` of the regular `__call__` method (either in the same call as your audio inputs, or in a separate call.
  warnings.warn(
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/processing_wav2vec2.py:155: UserWarning: `as_target_processor` is deprecated and will be removed in v5 of Transformers. You can process your labels by using the argument `text` of the regular `__call__` method (either in the same call as your audio inputs, or in a separate call.
  warnings.warn(
/home/z5313567/.local/lib/python3.10/site-packages/transformers/feature_extraction_utils.py:166: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  tensor = as_tensor(value)
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/processing_wav2vec2.py:155: UserWarning: `as_target_processor` is deprecated and will be removed in v5 of Transformers. You can process your labels by using the argument `text` of the regular `__call__` method (either in the same call as your audio inputs, or in a separate call.
  warnings.warn(
/home/z5313567/.local/lib/python3.10/site-packages/transformers/feature_extraction_utils.py:166: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  tensor = as_tensor(value)
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/processing_wav2vec2.py:155: UserWarning: `as_target_processor` is deprecated and will be removed in v5 of Transformers. You can process your labels by using the argument `text` of the regular `__call__` method (either in the same call as your audio inputs, or in a separate call.
  warnings.warn(
Map (num_proc=4):   1%|▏         | 48/3643 [00:00<00:09, 365.19 examples/s]Map (num_proc=4):   5%|▌         | 184/3643 [00:00<00:04, 768.85 examples/s]Map (num_proc=4):   9%|▉         | 320/3643 [00:00<00:03, 954.10 examples/s]Map (num_proc=4):  12%|█▏        | 448/3643 [00:00<00:03, 980.15 examples/s]Map (num_proc=4):  16%|█▌        | 584/3643 [00:00<00:03, 960.54 examples/s]Map (num_proc=4):  20%|█▉        | 720/3643 [00:00<00:02, 1046.11 examples/s]Map (num_proc=4):  23%|██▎       | 840/3643 [00:00<00:02, 1016.11 examples/s]Map (num_proc=4):  26%|██▌       | 952/3643 [00:01<00:02, 987.95 examples/s] Map (num_proc=4):  30%|███       | 1104/3643 [00:01<00:02, 1061.55 examples/s]Map (num_proc=4):  34%|███▎      | 1224/3643 [00:01<00:02, 1044.44 examples/s]Map (num_proc=4):  37%|███▋      | 1344/3643 [00:01<00:02, 1061.66 examples/s]Map (num_proc=4):  41%|████      | 1480/3643 [00:01<00:02, 1047.78 examples/s]Map (num_proc=4):  45%|████▍     | 1624/3643 [00:01<00:01, 1113.03 examples/s]Map (num_proc=4):  48%|████▊     | 1752/3643 [00:01<00:01, 1147.00 examples/s]Map (num_proc=4):  52%|█████▏    | 1896/3643 [00:01<00:01, 1189.88 examples/s]Map (num_proc=4):  56%|█████▌    | 2024/3643 [00:01<00:01, 1149.20 examples/s]Map (num_proc=4):  59%|█████▉    | 2152/3643 [00:02<00:01, 1107.05 examples/s]Map (num_proc=4):  62%|██████▏   | 2264/3643 [00:02<00:01, 1041.89 examples/s]Map (num_proc=4):  65%|██████▌   | 2376/3643 [00:02<00:01, 992.73 examples/s] Map (num_proc=4):  69%|██████▊   | 2504/3643 [00:02<00:01, 979.62 examples/s]Map (num_proc=4):  72%|███████▏  | 2616/3643 [00:02<00:01, 999.77 examples/s]Map (num_proc=4):  75%|███████▍  | 2720/3643 [00:02<00:00, 985.69 examples/s]Map (num_proc=4):  78%|███████▊  | 2824/3643 [00:02<00:00, 991.72 examples/s]Map (num_proc=4):  81%|████████  | 2936/3643 [00:02<00:00, 938.60 examples/s]Map (num_proc=4):  83%|████████▎ | 3039/3643 [00:03<00:00, 867.31 examples/s]Map (num_proc=4):  86%|████████▌ | 3135/3643 [00:03<00:00, 821.66 examples/s]Map (num_proc=4):  88%|████████▊ | 3223/3643 [00:03<00:00, 783.91 examples/s]Map (num_proc=4):  91%|█████████ | 3311/3643 [00:03<00:00, 792.69 examples/s]Map (num_proc=4):  93%|█████████▎| 3398/3643 [00:03<00:00, 715.30 examples/s]Map (num_proc=4):  95%|█████████▌| 3476/3643 [00:03<00:00, 464.21 examples/s]Map (num_proc=4):  97%|█████████▋| 3540/3643 [00:04<00:00, 378.71 examples/s]Map (num_proc=4):  98%|█████████▊| 3588/3643 [00:04<00:00, 337.26 examples/s]Map (num_proc=4): 100%|█████████▉| 3636/3643 [00:04<00:00, 290.81 examples/s]                                                                             Map (num_proc=4):   0%|          | 0/3643 [00:00<?, ? examples/s]/home/z5313567/.local/lib/python3.10/site-packages/transformers/feature_extraction_utils.py:166: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  tensor = as_tensor(value)
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/processing_wav2vec2.py:155: UserWarning: `as_target_processor` is deprecated and will be removed in v5 of Transformers. You can process your labels by using the argument `text` of the regular `__call__` method (either in the same call as your audio inputs, or in a separate call.
  warnings.warn(
/home/z5313567/.local/lib/python3.10/site-packages/transformers/feature_extraction_utils.py:166: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  tensor = as_tensor(value)
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/processing_wav2vec2.py:155: UserWarning: `as_target_processor` is deprecated and will be removed in v5 of Transformers. You can process your labels by using the argument `text` of the regular `__call__` method (either in the same call as your audio inputs, or in a separate call.
  warnings.warn(
/home/z5313567/.local/lib/python3.10/site-packages/transformers/feature_extraction_utils.py:166: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  tensor = as_tensor(value)
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/processing_wav2vec2.py:155: UserWarning: `as_target_processor` is deprecated and will be removed in v5 of Transformers. You can process your labels by using the argument `text` of the regular `__call__` method (either in the same call as your audio inputs, or in a separate call.
  warnings.warn(
/home/z5313567/.local/lib/python3.10/site-packages/transformers/feature_extraction_utils.py:166: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  tensor = as_tensor(value)
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/processing_wav2vec2.py:155: UserWarning: `as_target_processor` is deprecated and will be removed in v5 of Transformers. You can process your labels by using the argument `text` of the regular `__call__` method (either in the same call as your audio inputs, or in a separate call.
  warnings.warn(
Map (num_proc=4):   1%|▏         | 48/3643 [00:00<00:09, 373.70 examples/s]Map (num_proc=4):   5%|▌         | 184/3643 [00:00<00:04, 743.91 examples/s]Map (num_proc=4):   9%|▊         | 312/3643 [00:00<00:03, 901.30 examples/s]Map (num_proc=4):  13%|█▎        | 464/3643 [00:00<00:03, 971.72 examples/s]Map (num_proc=4):  16%|█▋        | 600/3643 [00:00<00:03, 1007.77 examples/s]Map (num_proc=4):  20%|██        | 744/3643 [00:00<00:02, 999.59 examples/s] Map (num_proc=4):  23%|██▎       | 856/3643 [00:00<00:02, 1030.92 examples/s]Map (num_proc=4):  27%|██▋       | 1000/3643 [00:01<00:02, 1068.08 examples/s]Map (num_proc=4):  32%|███▏      | 1152/3643 [00:01<00:02, 1150.68 examples/s]Map (num_proc=4):  35%|███▌      | 1280/3643 [00:01<00:02, 1157.46 examples/s]Map (num_proc=4):  38%|███▊      | 1400/3643 [00:01<00:01, 1160.60 examples/s]Map (num_proc=4):  42%|████▏     | 1520/3643 [00:01<00:01, 1119.05 examples/s]Map (num_proc=4):  45%|████▌     | 1656/3643 [00:01<00:01, 1162.28 examples/s]Map (num_proc=4):  50%|████▉     | 1808/3643 [00:01<00:01, 1244.65 examples/s]Map (num_proc=4):  53%|█████▎    | 1936/3643 [00:01<00:01, 1250.67 examples/s]Map (num_proc=4):  57%|█████▋    | 2072/3643 [00:01<00:01, 1192.86 examples/s]Map (num_proc=4):  61%|██████    | 2208/3643 [00:02<00:01, 1227.47 examples/s]Map (num_proc=4):  64%|██████▍   | 2336/3643 [00:02<00:01, 1181.04 examples/s]Map (num_proc=4):  68%|██████▊   | 2464/3643 [00:02<00:01, 1173.49 examples/s]Map (num_proc=4):  71%|███████▏  | 2600/3643 [00:02<00:00, 1058.99 examples/s]Map (num_proc=4):  74%|███████▍  | 2712/3643 [00:02<00:00, 1030.37 examples/s]Map (num_proc=4):  78%|███████▊  | 2840/3643 [00:02<00:00, 1028.98 examples/s]Map (num_proc=4):  81%|████████▏ | 2960/3643 [00:02<00:00, 1027.09 examples/s]Map (num_proc=4):  85%|████████▍ | 3079/3643 [00:02<00:00, 938.20 examples/s] Map (num_proc=4):  87%|████████▋ | 3183/3643 [00:03<00:00, 867.35 examples/s]Map (num_proc=4):  90%|█████████ | 3287/3643 [00:03<00:00, 851.23 examples/s]Map (num_proc=4):  93%|█████████▎| 3375/3643 [00:03<00:00, 820.71 examples/s]Map (num_proc=4):  96%|█████████▌| 3501/3643 [00:03<00:00, 881.28 examples/s]Map (num_proc=4):  99%|█████████▉| 3604/3643 [00:03<00:00, 640.86 examples/s]                                                                             /srv/scratch/z5313567/thesis/wav2vec2/code/eval_AusKidTalk.py:573: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  wer_metric = load_metric("wer")
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py:1643: FutureWarning: The method `freeze_feature_extractor` is deprecated and will be removed in Transformers v5.Please use the equivalent `freeze_feature_encoder` method instead.
  warnings.warn(
SUCCESS: Data ready for training and evaluation.

------> PREPARING FOR TRAINING & EVALUATION... ----------------------- 

--> Defining data collator...
SUCCESS: Data collator defined.
--> Defining evaluation metric...
SUCCESS: Defined WER evaluation metric.
--> Loading pre-trained checkpoint...
SUCCESS: Pre-trained checkpoint loaded.

------> EVALUATING MODEL... ------------------------------------------ 

Map:   0%|          | 0/3643 [00:00<?, ? examples/s]Map:   0%|          | 1/3643 [00:01<1:50:23,  1.82s/ examples]Map:   0%|          | 8/3643 [00:01<10:53,  5.56 examples/s]  Map:   0%|          | 15/3643 [00:02<05:19, 11.36 examples/s]Map:   1%|          | 22/3643 [00:02<03:22, 17.89 examples/s]Map:   1%|          | 30/3643 [00:02<02:17, 26.20 examples/s]Map:   1%|          | 39/3643 [00:02<01:41, 35.53 examples/s]Map:   1%|▏         | 48/3643 [00:02<01:21, 43.85 examples/s]Map:   2%|▏         | 56/3643 [00:02<01:11, 50.19 examples/s]Map:   2%|▏         | 66/3643 [00:02<01:01, 57.93 examples/s]Map:   2%|▏         | 74/3643 [00:02<00:58, 60.90 examples/s]Map:   2%|▏         | 82/3643 [00:02<00:55, 64.11 examples/s]Map:   2%|▏         | 90/3643 [00:03<00:54, 65.38 examples/s]Map:   3%|▎         | 98/3643 [00:03<00:51, 68.22 examples/s]Map:   3%|▎         | 106/3643 [00:03<00:51, 68.30 examples/s]Map:   3%|▎         | 114/3643 [00:03<00:52, 67.21 examples/s]Map:   3%|▎         | 122/3643 [00:03<00:52, 66.45 examples/s]Map:   4%|▎         | 130/3643 [00:03<00:51, 68.22 examples/s]Map:   4%|▍         | 138/3643 [00:03<00:50, 69.01 examples/s]Map:   4%|▍         | 147/3643 [00:03<00:48, 72.35 examples/s]Map:   4%|▍         | 155/3643 [00:04<00:48, 72.07 examples/s]Map:   4%|▍         | 163/3643 [00:04<00:47, 72.84 examples/s]Map:   5%|▍         | 171/3643 [00:04<00:47, 73.82 examples/s]Map:   5%|▍         | 181/3643 [00:04<00:44, 77.60 examples/s]Map:   5%|▌         | 191/3643 [00:04<00:43, 80.19 examples/s]Map:   5%|▌         | 200/3643 [00:04<00:43, 79.69 examples/s]Map:   6%|▌         | 210/3643 [00:04<00:41, 83.27 examples/s]Map:   6%|▌         | 220/3643 [00:04<00:41, 83.44 examples/s]Map:   6%|▋         | 232/3643 [00:04<00:43, 78.87 examples/s]Map:   7%|▋         | 240/3643 [00:05<00:43, 77.70 examples/s]Map:   7%|▋         | 250/3643 [00:05<00:42, 79.34 examples/s]Map:   7%|▋         | 259/3643 [00:05<00:42, 80.29 examples/s]Map:   7%|▋         | 269/3643 [00:05<00:41, 81.96 examples/s]Map:   8%|▊         | 279/3643 [00:05<00:41, 81.43 examples/s]Map:   8%|▊         | 289/3643 [00:05<00:40, 82.25 examples/s]Map:   8%|▊         | 298/3643 [00:05<00:41, 80.92 examples/s]Map:   8%|▊         | 307/3643 [00:05<00:41, 80.86 examples/s]Map:   9%|▊         | 316/3643 [00:05<00:40, 81.91 examples/s]Map:   9%|▉         | 325/3643 [00:06<00:40, 81.59 examples/s]Map:   9%|▉         | 334/3643 [00:06<00:40, 81.39 examples/s]Map:   9%|▉         | 343/3643 [00:06<00:40, 80.94 examples/s]Map:  10%|▉         | 355/3643 [00:06<00:42, 76.51 examples/s]Map:  10%|█         | 365/3643 [00:06<00:42, 77.85 examples/s]Map:  10%|█         | 375/3643 [00:06<00:40, 81.40 examples/s]Map:  11%|█         | 385/3643 [00:06<00:39, 82.98 examples/s]Map:  11%|█         | 396/3643 [00:07<00:41, 77.59 examples/s]Map:  11%|█         | 405/3643 [00:07<00:41, 77.57 examples/s]Map:  11%|█▏        | 415/3643 [00:07<00:39, 81.36 examples/s]Map:  12%|█▏        | 425/3643 [00:07<00:38, 83.69 examples/s]Map:  12%|█▏        | 434/3643 [00:07<00:38, 83.78 examples/s]Map:  12%|█▏        | 444/3643 [00:07<00:38, 84.02 examples/s]Map:  12%|█▏        | 454/3643 [00:07<00:37, 84.61 examples/s]Map:  13%|█▎        | 464/3643 [00:07<00:37, 85.67 examples/s]Map:  13%|█▎        | 474/3643 [00:07<00:36, 87.89 examples/s]Map:  13%|█▎        | 484/3643 [00:08<00:36, 87.50 examples/s]Map:  14%|█▎        | 493/3643 [00:08<00:37, 84.71 examples/s]Map:  14%|█▍        | 505/3643 [00:08<00:39, 80.01 examples/s]Map:  14%|█▍        | 518/3643 [00:08<00:39, 78.84 examples/s]Map:  14%|█▍        | 526/3643 [00:08<00:40, 77.70 examples/s]Map:  15%|█▍        | 534/3643 [00:08<00:40, 77.18 examples/s]Map:  15%|█▍        | 543/3643 [00:08<00:39, 78.03 examples/s]Map:  15%|█▌        | 551/3643 [00:08<00:40, 76.63 examples/s]Map:  15%|█▌        | 560/3643 [00:09<00:40, 76.31 examples/s]Map:  16%|█▌        | 569/3643 [00:09<00:39, 78.26 examples/s]Map:  16%|█▌        | 578/3643 [00:09<00:39, 78.18 examples/s]Map:  16%|█▌        | 586/3643 [00:09<00:40, 75.41 examples/s]Map:  16%|█▋        | 594/3643 [00:09<00:40, 75.07 examples/s]Map:  17%|█▋        | 602/3643 [00:09<00:40, 74.72 examples/s]Map:  17%|█▋        | 613/3643 [00:09<00:42, 71.73 examples/s]Map:  17%|█▋        | 623/3643 [00:09<00:43, 68.67 examples/s]Map:  17%|█▋        | 630/3643 [00:10<00:43, 68.57 examples/s]Map:  18%|█▊        | 638/3643 [00:10<00:42, 70.14 examples/s]Map:  18%|█▊        | 649/3643 [00:10<00:42, 69.86 examples/s]Map:  18%|█▊        | 657/3643 [00:10<00:42, 71.05 examples/s]Map:  18%|█▊        | 665/3643 [00:10<00:42, 70.51 examples/s]Map:  19%|█▊        | 675/3643 [00:10<00:39, 75.16 examples/s]Map:  19%|█▉        | 687/3643 [00:10<00:39, 75.07 examples/s]Map:  19%|█▉        | 697/3643 [00:10<00:37, 78.93 examples/s]Map:  19%|█▉        | 707/3643 [00:11<00:36, 80.94 examples/s]Map:  20%|█▉        | 717/3643 [00:11<00:34, 83.87 examples/s]Map:  20%|█▉        | 726/3643 [00:11<00:34, 83.36 examples/s]Map:  20%|██        | 735/3643 [00:11<00:35, 81.89 examples/s]Map:  21%|██        | 748/3643 [00:11<00:35, 80.64 examples/s]Map:  21%|██        | 758/3643 [00:11<00:35, 81.78 examples/s]Map:  21%|██        | 768/3643 [00:11<00:35, 81.89 examples/s]Map:  21%|██▏       | 781/3643 [00:11<00:35, 80.86 examples/s]Map:  22%|██▏       | 792/3643 [00:12<00:33, 85.10 examples/s]Map:  22%|██▏       | 802/3643 [00:12<00:32, 86.16 examples/s]Map:  22%|██▏       | 814/3643 [00:12<00:34, 82.77 examples/s]Map:  23%|██▎       | 823/3643 [00:12<00:34, 82.52 examples/s]Map:  23%|██▎       | 833/3643 [00:12<00:33, 83.59 examples/s]Map:  23%|██▎       | 843/3643 [00:12<00:32, 85.32 examples/s]Map:  23%|██▎       | 854/3643 [00:12<00:31, 88.14 examples/s]Map:  24%|██▎       | 863/3643 [00:12<00:32, 86.60 examples/s]Map:  24%|██▍       | 873/3643 [00:12<00:31, 87.19 examples/s]Map:  24%|██▍       | 882/3643 [00:13<00:32, 85.95 examples/s]Map:  25%|██▍       | 895/3643 [00:13<00:32, 84.24 examples/s]Map:  25%|██▍       | 905/3643 [00:13<00:32, 83.44 examples/s]Map:  25%|██▌       | 915/3643 [00:13<00:32, 84.17 examples/s]Map:  25%|██▌       | 927/3643 [00:13<00:33, 80.95 examples/s]Map:  26%|██▌       | 936/3643 [00:13<00:33, 80.79 examples/s]Map:  26%|██▌       | 946/3643 [00:13<00:32, 84.11 examples/s]Map:  26%|██▌       | 955/3643 [00:13<00:32, 83.62 examples/s]Map:  27%|██▋       | 968/3643 [00:14<00:32, 82.05 examples/s]Map:  27%|██▋       | 978/3643 [00:14<00:31, 83.63 examples/s]Map:  27%|██▋       | 987/3643 [00:14<00:31, 84.78 examples/s]Map:  27%|██▋       | 996/3643 [00:14<00:31, 84.32 examples/s]Map:  28%|██▊       | 1005/3643 [00:15<01:09, 37.99 examples/s]Map:  28%|██▊       | 1013/3643 [00:15<01:00, 43.64 examples/s]Map:  28%|██▊       | 1021/3643 [00:15<00:53, 49.44 examples/s]Map:  28%|██▊       | 1029/3643 [00:15<00:47, 55.19 examples/s]Map:  29%|██▊       | 1040/3643 [00:15<00:40, 64.89 examples/s]Map:  29%|██▉       | 1050/3643 [00:15<00:36, 71.54 examples/s]Map:  29%|██▉       | 1060/3643 [00:15<00:33, 77.15 examples/s]Map:  29%|██▉       | 1070/3643 [00:15<00:32, 78.20 examples/s]Map:  30%|██▉       | 1080/3643 [00:15<00:31, 80.78 examples/s]Map:  30%|██▉       | 1090/3643 [00:16<00:30, 82.92 examples/s]Map:  30%|███       | 1100/3643 [00:16<00:30, 84.12 examples/s]Map:  30%|███       | 1110/3643 [00:16<00:29, 85.35 examples/s]Map:  31%|███       | 1119/3643 [00:16<00:29, 85.27 examples/s]Map:  31%|███       | 1128/3643 [00:16<00:30, 83.06 examples/s]Map:  31%|███▏      | 1139/3643 [00:16<00:29, 86.31 examples/s]Map:  32%|███▏      | 1149/3643 [00:16<00:28, 87.15 examples/s]Map:  32%|███▏      | 1159/3643 [00:16<00:27, 88.72 examples/s]Map:  32%|███▏      | 1170/3643 [00:16<00:26, 91.79 examples/s]Map:  32%|███▏      | 1183/3643 [00:17<00:28, 87.01 examples/s]Map:  33%|███▎      | 1192/3643 [00:17<00:28, 84.67 examples/s]Map:  33%|███▎      | 1201/3643 [00:17<00:28, 84.37 examples/s]Map:  33%|███▎      | 1213/3643 [00:17<00:27, 89.88 examples/s]Map:  34%|███▎      | 1225/3643 [00:17<00:25, 93.79 examples/s]Map:  34%|███▍      | 1236/3643 [00:17<00:25, 95.18 examples/s]Map:  34%|███▍      | 1246/3643 [00:17<00:25, 93.08 examples/s]Map:  34%|███▍      | 1256/3643 [00:17<00:26, 90.47 examples/s]Map:  35%|███▍      | 1269/3643 [00:18<00:27, 85.97 examples/s]Map:  35%|███▌      | 1278/3643 [00:18<00:27, 84.86 examples/s]Map:  35%|███▌      | 1289/3643 [00:18<00:26, 88.90 examples/s]Map:  36%|███▌      | 1298/3643 [00:18<00:26, 87.99 examples/s]Map:  36%|███▌      | 1311/3643 [00:18<00:27, 85.66 examples/s]Map:  36%|███▋      | 1321/3643 [00:18<00:26, 87.88 examples/s]Map:  37%|███▋      | 1332/3643 [00:18<00:25, 91.51 examples/s]Map:  37%|███▋      | 1342/3643 [00:18<00:24, 93.05 examples/s]Map:  37%|███▋      | 1353/3643 [00:18<00:24, 94.26 examples/s]Map:  37%|███▋      | 1363/3643 [00:19<00:24, 93.52 examples/s]Map:  38%|███▊      | 1373/3643 [00:19<00:24, 93.07 examples/s]Map:  38%|███▊      | 1384/3643 [00:19<00:23, 94.76 examples/s]Map:  38%|███▊      | 1394/3643 [00:19<00:23, 94.11 examples/s]Map:  39%|███▊      | 1404/3643 [00:19<00:23, 94.05 examples/s]Map:  39%|███▉      | 1414/3643 [00:19<00:23, 94.29 examples/s]Map:  39%|███▉      | 1426/3643 [00:19<00:22, 97.07 examples/s]Map:  39%|███▉      | 1437/3643 [00:19<00:22, 98.46 examples/s]Map:  40%|███▉      | 1448/3643 [00:19<00:22, 99.70 examples/s]Map:  40%|████      | 1459/3643 [00:20<00:21, 99.59 examples/s]Map:  40%|████      | 1470/3643 [00:20<00:21, 99.10 examples/s]Map:  41%|████      | 1480/3643 [00:20<00:22, 94.16 examples/s]Map:  41%|████      | 1490/3643 [00:20<00:22, 94.24 examples/s]Map:  41%|████      | 1500/3643 [00:20<00:22, 93.91 examples/s]Map:  41%|████▏     | 1510/3643 [00:20<00:22, 94.13 examples/s]Map:  42%|████▏     | 1520/3643 [00:20<00:22, 95.46 examples/s]Map:  42%|████▏     | 1530/3643 [00:20<00:22, 95.04 examples/s]Map:  42%|████▏     | 1542/3643 [00:20<00:21, 97.07 examples/s]Map:  43%|████▎     | 1555/3643 [00:21<00:23, 88.99 examples/s]Map:  43%|████▎     | 1566/3643 [00:21<00:23, 90.26 examples/s]Map:  43%|████▎     | 1576/3643 [00:21<00:23, 89.18 examples/s]Map:  44%|████▎     | 1589/3643 [00:21<00:23, 86.44 examples/s]Map:  44%|████▍     | 1599/3643 [00:21<00:23, 86.96 examples/s]Map:  44%|████▍     | 1608/3643 [00:21<00:24, 82.76 examples/s]Map:  44%|████▍     | 1617/3643 [00:21<00:24, 83.28 examples/s]Map:  45%|████▍     | 1626/3643 [00:21<00:24, 83.51 examples/s]Map:  45%|████▍     | 1639/3643 [00:22<00:24, 81.56 examples/s]Map:  45%|████▌     | 1648/3643 [00:22<00:24, 80.74 examples/s]Map:  46%|████▌     | 1658/3643 [00:22<00:23, 82.75 examples/s]Map:  46%|████▌     | 1667/3643 [00:22<00:23, 82.85 examples/s]Map:  46%|████▌     | 1677/3643 [00:22<00:23, 85.13 examples/s]Map:  46%|████▋     | 1686/3643 [00:22<00:23, 83.45 examples/s]Map:  47%|████▋     | 1698/3643 [00:22<00:24, 80.67 examples/s]Map:  47%|████▋     | 1708/3643 [00:22<00:23, 81.18 examples/s]Map:  47%|████▋     | 1717/3643 [00:23<00:24, 80.16 examples/s]Map:  47%|████▋     | 1727/3643 [00:23<00:22, 83.40 examples/s]Map:  48%|████▊     | 1737/3643 [00:23<00:22, 85.40 examples/s]Map:  48%|████▊     | 1747/3643 [00:23<00:22, 85.05 examples/s]Map:  48%|████▊     | 1757/3643 [00:23<00:21, 87.72 examples/s]Map:  49%|████▊     | 1767/3643 [00:23<00:21, 87.97 examples/s]Map:  49%|████▉     | 1776/3643 [00:23<00:21, 87.67 examples/s]Map:  49%|████▉     | 1785/3643 [00:23<00:22, 83.38 examples/s]Map:  49%|████▉     | 1795/3643 [00:23<00:21, 86.21 examples/s]Map:  50%|████▉     | 1805/3643 [00:24<00:20, 87.87 examples/s]Map:  50%|████▉     | 1818/3643 [00:24<00:21, 84.02 examples/s]Map:  50%|█████     | 1830/3643 [00:24<00:23, 78.76 examples/s]Map:  51%|█████     | 1840/3643 [00:24<00:22, 80.75 examples/s]Map:  51%|█████     | 1849/3643 [00:24<00:22, 80.87 examples/s]Map:  51%|█████     | 1858/3643 [00:24<00:21, 81.97 examples/s]Map:  51%|█████     | 1867/3643 [00:24<00:21, 81.92 examples/s]Map:  52%|█████▏    | 1880/3643 [00:25<00:22, 79.50 examples/s]Map:  52%|█████▏    | 1890/3643 [00:25<00:21, 83.06 examples/s]Map:  52%|█████▏    | 1902/3643 [00:25<00:21, 79.21 examples/s]Map:  53%|█████▎    | 1913/3643 [00:25<00:20, 84.51 examples/s]Map:  53%|█████▎    | 1923/3643 [00:25<00:19, 86.27 examples/s]Map:  53%|█████▎    | 1932/3643 [00:25<00:20, 82.05 examples/s]Map:  53%|█████▎    | 1941/3643 [00:25<00:20, 83.39 examples/s]Map:  54%|█████▎    | 1951/3643 [00:25<00:19, 85.82 examples/s]Map:  54%|█████▍    | 1961/3643 [00:25<00:19, 86.57 examples/s]Map:  54%|█████▍    | 1973/3643 [00:26<00:20, 82.44 examples/s]Map:  54%|█████▍    | 1982/3643 [00:26<00:19, 84.04 examples/s]Map:  55%|█████▍    | 1991/3643 [00:26<00:19, 83.80 examples/s]Map:  55%|█████▍    | 2000/3643 [00:26<00:37, 43.36 examples/s]Map:  55%|█████▌    | 2007/3643 [00:26<00:34, 46.90 examples/s]Map:  55%|█████▌    | 2016/3643 [00:26<00:29, 54.58 examples/s]Map:  56%|█████▌    | 2025/3643 [00:27<00:26, 60.14 examples/s]Map:  56%|█████▌    | 2034/3643 [00:27<00:24, 64.96 examples/s]Map:  56%|█████▌    | 2042/3643 [00:27<00:24, 65.27 examples/s]Map:  56%|█████▋    | 2051/3643 [00:27<00:22, 69.93 examples/s]Map:  57%|█████▋    | 2061/3643 [00:27<00:21, 74.19 examples/s]Map:  57%|█████▋    | 2070/3643 [00:27<00:20, 76.75 examples/s]Map:  57%|█████▋    | 2079/3643 [00:27<00:20, 78.12 examples/s]Map:  57%|█████▋    | 2090/3643 [00:27<00:18, 82.10 examples/s]Map:  58%|█████▊    | 2100/3643 [00:28<00:18, 81.43 examples/s]Map:  58%|█████▊    | 2109/3643 [00:28<00:19, 80.25 examples/s]Map:  58%|█████▊    | 2118/3643 [00:28<00:19, 79.69 examples/s]Map:  58%|█████▊    | 2131/3643 [00:28<00:18, 80.03 examples/s]Map:  59%|█████▉    | 2141/3643 [00:28<00:18, 82.38 examples/s]Map:  59%|█████▉    | 2150/3643 [00:28<00:18, 82.08 examples/s]Map:  59%|█████▉    | 2160/3643 [00:28<00:18, 80.06 examples/s]Map:  60%|█████▉    | 2170/3643 [00:28<00:17, 81.98 examples/s]Map:  60%|█████▉    | 2180/3643 [00:29<00:17, 83.40 examples/s]Map:  60%|██████    | 2192/3643 [00:29<00:18, 79.91 examples/s]Map:  60%|██████    | 2202/3643 [00:29<00:17, 80.33 examples/s]Map:  61%|██████    | 2214/3643 [00:29<00:18, 77.22 examples/s]Map:  61%|██████    | 2222/3643 [00:29<00:18, 75.77 examples/s]Map:  61%|██████    | 2231/3643 [00:29<00:18, 76.15 examples/s]Map:  61%|██████▏   | 2240/3643 [00:29<00:18, 76.85 examples/s]Map:  62%|██████▏   | 2249/3643 [00:29<00:17, 78.34 examples/s]Map:  62%|██████▏   | 2257/3643 [00:30<00:17, 77.47 examples/s]Map:  62%|██████▏   | 2267/3643 [00:30<00:17, 78.60 examples/s]Map:  62%|██████▏   | 2276/3643 [00:30<00:17, 80.29 examples/s]Map:  63%|██████▎   | 2286/3643 [00:30<00:16, 81.12 examples/s]Map:  63%|██████▎   | 2297/3643 [00:30<00:15, 86.24 examples/s]Map:  63%|██████▎   | 2309/3643 [00:30<00:16, 81.34 examples/s]Map:  64%|██████▎   | 2319/3643 [00:30<00:15, 83.84 examples/s]Map:  64%|██████▍   | 2329/3643 [00:30<00:15, 83.44 examples/s]Map:  64%|██████▍   | 2339/3643 [00:30<00:15, 83.61 examples/s]Map:  64%|██████▍   | 2349/3643 [00:31<00:15, 82.54 examples/s]Map:  65%|██████▍   | 2362/3643 [00:31<00:15, 81.96 examples/s]Map:  65%|██████▌   | 2375/3643 [00:31<00:15, 80.51 examples/s]Map:  66%|██████▌   | 2387/3643 [00:31<00:16, 76.94 examples/s]Map:  66%|██████▌   | 2395/3643 [00:31<00:16, 76.35 examples/s]Map:  66%|██████▌   | 2403/3643 [00:31<00:16, 75.28 examples/s]Map:  66%|██████▌   | 2411/3643 [00:31<00:16, 74.03 examples/s]Map:  66%|██████▋   | 2420/3643 [00:32<00:16, 74.97 examples/s]Map:  67%|██████▋   | 2428/3643 [00:32<00:16, 74.50 examples/s]Map:  67%|██████▋   | 2436/3643 [00:32<00:16, 72.80 examples/s]Map:  67%|██████▋   | 2447/3643 [00:32<00:17, 69.56 examples/s]Map:  67%|██████▋   | 2456/3643 [00:32<00:18, 62.57 examples/s]Map:  68%|██████▊   | 2465/3643 [00:32<00:17, 66.62 examples/s]Map:  68%|██████▊   | 2474/3643 [00:32<00:17, 67.19 examples/s]Map:  68%|██████▊   | 2482/3643 [00:32<00:16, 69.15 examples/s]Map:  68%|██████▊   | 2491/3643 [00:33<00:16, 71.07 examples/s]Map:  69%|██████▊   | 2499/3643 [00:33<00:15, 72.81 examples/s]Map:  69%|██████▉   | 2507/3643 [00:33<00:15, 71.84 examples/s]Map:  69%|██████▉   | 2517/3643 [00:33<00:16, 68.44 examples/s]Map:  69%|██████▉   | 2525/3643 [00:33<00:16, 68.46 examples/s]Map:  70%|██████▉   | 2533/3643 [00:33<00:16, 68.50 examples/s]Map:  70%|██████▉   | 2543/3643 [00:33<00:14, 73.62 examples/s]Map:  70%|███████   | 2551/3643 [00:33<00:14, 73.94 examples/s]Map:  70%|███████   | 2560/3643 [00:34<00:14, 76.10 examples/s]Map:  71%|███████   | 2569/3643 [00:34<00:13, 77.29 examples/s]Map:  71%|███████   | 2579/3643 [00:34<00:13, 80.56 examples/s]Map:  71%|███████   | 2588/3643 [00:34<00:12, 81.85 examples/s]Map:  71%|███████▏  | 2598/3643 [00:34<00:12, 85.03 examples/s]Map:  72%|███████▏  | 2607/3643 [00:34<00:12, 81.23 examples/s]Map:  72%|███████▏  | 2619/3643 [00:34<00:13, 78.47 examples/s]Map:  72%|███████▏  | 2628/3643 [00:34<00:12, 79.18 examples/s]Map:  72%|███████▏  | 2637/3643 [00:35<00:12, 80.14 examples/s]Map:  73%|███████▎  | 2646/3643 [00:35<00:12, 80.46 examples/s]Map:  73%|███████▎  | 2655/3643 [00:35<00:12, 80.91 examples/s]Map:  73%|███████▎  | 2665/3643 [00:35<00:12, 81.49 examples/s]Map:  73%|███████▎  | 2674/3643 [00:35<00:11, 82.40 examples/s]Map:  74%|███████▎  | 2683/3643 [00:35<00:11, 81.67 examples/s]Map:  74%|███████▍  | 2692/3643 [00:35<00:11, 81.63 examples/s]Map:  74%|███████▍  | 2704/3643 [00:35<00:11, 79.20 examples/s]Map:  74%|███████▍  | 2712/3643 [00:35<00:12, 77.36 examples/s]Map:  75%|███████▍  | 2720/3643 [00:36<00:12, 76.66 examples/s]Map:  75%|███████▍  | 2730/3643 [00:36<00:11, 80.21 examples/s]Map:  75%|███████▌  | 2739/3643 [00:36<00:10, 82.31 examples/s]Map:  75%|███████▌  | 2748/3643 [00:36<00:10, 81.69 examples/s]Map:  76%|███████▌  | 2761/3643 [00:36<00:11, 79.54 examples/s]Map:  76%|███████▌  | 2770/3643 [00:36<00:10, 79.54 examples/s]Map:  76%|███████▋  | 2782/3643 [00:36<00:11, 77.79 examples/s]Map:  77%|███████▋  | 2792/3643 [00:36<00:10, 79.30 examples/s]Map:  77%|███████▋  | 2801/3643 [00:37<00:10, 79.83 examples/s]Map:  77%|███████▋  | 2810/3643 [00:37<00:10, 80.09 examples/s]Map:  77%|███████▋  | 2820/3643 [00:37<00:10, 81.51 examples/s]Map:  78%|███████▊  | 2830/3643 [00:37<00:09, 83.84 examples/s]Map:  78%|███████▊  | 2843/3643 [00:37<00:09, 82.58 examples/s]Map:  78%|███████▊  | 2856/3643 [00:37<00:09, 80.49 examples/s]Map:  79%|███████▊  | 2868/3643 [00:37<00:09, 79.58 examples/s]Map:  79%|███████▉  | 2877/3643 [00:37<00:09, 79.42 examples/s]Map:  79%|███████▉  | 2887/3643 [00:38<00:09, 81.69 examples/s]Map:  80%|███████▉  | 2898/3643 [00:38<00:08, 85.18 examples/s]Map:  80%|███████▉  | 2907/3643 [00:38<00:08, 83.00 examples/s]Map:  80%|████████  | 2917/3643 [00:38<00:08, 84.70 examples/s]Map:  80%|████████  | 2927/3643 [00:38<00:08, 85.09 examples/s]Map:  81%|████████  | 2939/3643 [00:38<00:08, 81.39 examples/s]Map:  81%|████████  | 2951/3643 [00:38<00:08, 79.29 examples/s]Map:  81%|████████▏ | 2960/3643 [00:39<00:08, 78.89 examples/s]Map:  81%|████████▏ | 2969/3643 [00:39<00:08, 79.88 examples/s]Map:  82%|████████▏ | 2979/3643 [00:39<00:08, 81.26 examples/s]Map:  82%|████████▏ | 2988/3643 [00:39<00:07, 82.92 examples/s]Map:  82%|████████▏ | 2998/3643 [00:39<00:07, 82.77 examples/s]Map:  83%|████████▎ | 3009/3643 [00:40<00:17, 37.09 examples/s]Map:  83%|████████▎ | 3018/3643 [00:40<00:14, 43.47 examples/s]Map:  83%|████████▎ | 3028/3643 [00:40<00:11, 51.41 examples/s]Map:  83%|████████▎ | 3038/3643 [00:40<00:10, 59.03 examples/s]Map:  84%|████████▎ | 3048/3643 [00:40<00:09, 65.26 examples/s]Map:  84%|████████▍ | 3058/3643 [00:40<00:08, 70.46 examples/s]Map:  84%|████████▍ | 3067/3643 [00:40<00:07, 73.18 examples/s]Map:  84%|████████▍ | 3077/3643 [00:40<00:07, 77.94 examples/s]Map:  85%|████████▍ | 3087/3643 [00:40<00:06, 80.42 examples/s]Map:  85%|████████▌ | 3097/3643 [00:41<00:06, 82.03 examples/s]Map:  85%|████████▌ | 3107/3643 [00:41<00:06, 83.41 examples/s]Map:  86%|████████▌ | 3117/3643 [00:41<00:06, 85.01 examples/s]Map:  86%|████████▌ | 3126/3643 [00:41<00:06, 83.49 examples/s]Map:  86%|████████▌ | 3136/3643 [00:41<00:05, 85.03 examples/s]Map:  86%|████████▋ | 3146/3643 [00:41<00:05, 86.72 examples/s]Map:  87%|████████▋ | 3155/3643 [00:41<00:05, 85.26 examples/s]Map:  87%|████████▋ | 3164/3643 [00:41<00:05, 83.68 examples/s]Map:  87%|████████▋ | 3175/3643 [00:42<00:05, 78.30 examples/s]Map:  87%|████████▋ | 3185/3643 [00:42<00:05, 81.06 examples/s]Map:  88%|████████▊ | 3195/3643 [00:42<00:05, 82.06 examples/s]Map:  88%|████████▊ | 3205/3643 [00:42<00:05, 82.52 examples/s]Map:  88%|████████▊ | 3218/3643 [00:42<00:05, 80.80 examples/s]Map:  89%|████████▊ | 3228/3643 [00:42<00:05, 82.98 examples/s]Map:  89%|████████▉ | 3237/3643 [00:42<00:04, 82.14 examples/s]Map:  89%|████████▉ | 3247/3643 [00:42<00:04, 82.63 examples/s]Map:  89%|████████▉ | 3256/3643 [00:43<00:04, 81.61 examples/s]Map:  90%|████████▉ | 3265/3643 [00:43<00:04, 81.54 examples/s]Map:  90%|████████▉ | 3275/3643 [00:43<00:04, 85.23 examples/s]Map:  90%|█████████ | 3284/3643 [00:43<00:04, 83.95 examples/s]Map:  90%|█████████ | 3293/3643 [00:43<00:04, 84.64 examples/s]Map:  91%|█████████ | 3303/3643 [00:43<00:03, 86.50 examples/s]Map:  91%|█████████ | 3316/3643 [00:43<00:03, 82.90 examples/s]Map:  91%|█████████▏| 3326/3643 [00:43<00:03, 81.71 examples/s]Map:  92%|█████████▏| 3335/3643 [00:43<00:03, 82.19 examples/s]Map:  92%|█████████▏| 3345/3643 [00:44<00:03, 82.95 examples/s]Map:  92%|█████████▏| 3354/3643 [00:44<00:03, 83.35 examples/s]Map:  92%|█████████▏| 3363/3643 [00:44<00:03, 83.71 examples/s]Map:  93%|█████████▎| 3373/3643 [00:44<00:03, 84.50 examples/s]Map:  93%|█████████▎| 3383/3643 [00:44<00:03, 85.61 examples/s]Map:  93%|█████████▎| 3393/3643 [00:44<00:02, 86.03 examples/s]Map:  93%|█████████▎| 3402/3643 [00:44<00:02, 82.16 examples/s]Map:  94%|█████████▎| 3415/3643 [00:44<00:02, 82.80 examples/s]Map:  94%|█████████▍| 3425/3643 [00:45<00:02, 83.40 examples/s]Map:  94%|█████████▍| 3438/3643 [00:45<00:02, 81.72 examples/s]Map:  95%|█████████▍| 3447/3643 [00:45<00:02, 80.76 examples/s]Map:  95%|█████████▍| 3459/3643 [00:45<00:02, 79.99 examples/s]Map:  95%|█████████▌| 3472/3643 [00:45<00:02, 78.76 examples/s]Map:  96%|█████████▌| 3481/3643 [00:45<00:02, 78.02 examples/s]Map:  96%|█████████▌| 3491/3643 [00:45<00:01, 78.98 examples/s]Map:  96%|█████████▌| 3501/3643 [00:46<00:01, 79.54 examples/s]Map:  96%|█████████▋| 3511/3643 [00:46<00:01, 81.62 examples/s]Map:  97%|█████████▋| 3520/3643 [00:46<00:01, 81.64 examples/s]Map:  97%|█████████▋| 3532/3643 [00:46<00:01, 80.07 examples/s]Map:  97%|█████████▋| 3544/3643 [00:46<00:01, 75.80 examples/s]Map:  98%|█████████▊| 3554/3643 [00:46<00:01, 78.58 examples/s]Map:  98%|█████████▊| 3563/3643 [00:46<00:01, 77.57 examples/s]Map:  98%|█████████▊| 3571/3643 [00:46<00:00, 77.27 examples/s]Map:  98%|█████████▊| 3580/3643 [00:47<00:00, 79.60 examples/s]Map:  99%|█████████▊| 3590/3643 [00:47<00:00, 80.69 examples/s]Map:  99%|█████████▉| 3603/3643 [00:47<00:00, 80.48 examples/s]Map:  99%|█████████▉| 3613/3643 [00:47<00:00, 81.90 examples/s]Map:  99%|█████████▉| 3622/3643 [00:47<00:00, 80.76 examples/s]Map: 100%|█████████▉| 3632/3643 [00:47<00:00, 83.59 examples/s]Map: 100%|█████████▉| 3642/3643 [00:47<00:00, 84.19 examples/s]                                                               Saved results to: /srv/scratch/z5313567/thesis/wav2vec2/finetuned_result/AusKidTalk/finetuned_result_AusKidTalk_20230704.csv
--> Getting fine-tuned test results...
Fine-tuned Test WER: 0.971
--> Showing some fine-tuned prediction errors...
  target_text pred_str
0       BELLY         
1         ONE      OOL
2    VEGEMITE         
3         ONE    WOOLE
4     CRICKET         
5         THE     THOW
6       ALOFT         
7       ALIEN         
8        WOOD         
9       OTHER         
--> Taking a deeper look...
<pad> <pad> <pad> <pad> <pad> <pad> <pad> <pad> <pad> <pad> <pad>

------> SUCCESSFULLY FINISHED ---------------------------------------- 

Finished: 05/07/2023 19:35:30
Wed Jul 5 19:51:18 AEST 2023
Found cached dataset csv (/srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1)
------------------------------------------------------------------------
                 run_finetune_kids.py                                   
------------------------------------------------------------------------
Running:  /srv/scratch/z5313567/thesis/wav2vec2/code/eval_AusKidTalk.py
Started: 05/07/2023 19:51:19

------> IMPORTING PACKAGES.... ---------------------------------------

-->Importing datasets...
-->Importing random...
-->Importing pandas & numpy...
-->Importing re...
-->Importing json...
-->Importing Wav2VecCTC...
-->Importing soundfile...
-->Importing librosa...
-->Importing torch, dataclasses & typing...
-->Importing from transformers for training...
-->Importing pyarrow for loading dataset...
-->SUCCESS! All packages imported.

------> EXPERIMENT ARGUMENTS ----------------------------------------- 

training: False
base_fp: /srv/scratch/z5313567/thesis/
model: wav2vec2
dataset_name: AusKidTalk
experiment_id: eval_20230705
cache_name: OGI-eval
use_checkpoint: True
checkpoint: /srv/scratch/z5313567/thesis/wav2vec2/model/OGI_American/finetune_full_20230704_3
use_pretrained_tokenizer: True
pretrained_tokenizer: facebook/wav2vec2-base-960h
eval_pretrained: True
eval_model: /srv/scratch/z5313567/thesis/wav2vec2/model/OGI_American/finetune_full_20230704_3
baseline_model: facebook/wav2vec2-base-960h
eval_baseline: False

------> MODEL ARGUMENTS... -------------------------------------------

hidden_dropout: 0.1
activation_dropout: 0.1
attention_dropoutput: 0.1
feat_proj_dropout: 0.0
layerdrop: 0.1
mask_time_prob: 0.05
mask_time_length: 10
ctc_loss_reduction: mean
ctc_zero_infinity: True
gradient_checkpointing: True

------> TRAINING ARGUMENTS... ----------------------------------------

evaluation strategy: steps
per_device_train_batch_size: 8
gradient_accumulation_steps: 1
learning_rate: 3e-05
weight_decay: 0.01
adam_beta1: 0.9
adam_beta2: 0.98
adam_epsilon: 1e-08
num_train_epochs: 14
max_steps: 60000
lr_scheduler_type: linear
warmup_ratio: 0.1
logging_strategy: steps
logging_steps: 1000
save_strategy: steps
save_steps: 1000
save_total_limit: 3
fp16: True
eval_steps: 1000
load_best_model_at_end: True
metric_for_best_model: wer
greater_is_better: False
group_by_length: True

------> GENERATING FILEPATHS... --------------------------------------

--> data_train_fp: /srv/scratch/z5313567/thesis/AusKidTalk_local/AusKidTalk_df_only_transcription_filepath.csv
--> data_test_fp: /srv/scratch/z5313567/thesis/AusKidTalk_local/AusKidTalk_df_only_transcription_filepath.csv
--> data_cache_fp: /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk
--> model_fp: /srv/scratch/z5313567/thesis/wav2vec2/model/Renee_myST_OGI_TLT/20211016_2-base-myST-OGI-TLT17
--> vocab_fp: /srv/scratch/z5313567/thesis/wav2vec2/vocab/AusKidTalk/vocab_AusKidTalk_20230704.json
--> baseline_results_fp: /srv/scratch/z5313567/thesis/wav2vec2/baseline_result/AusKidTalk/baseline_result_AusKidTalk_20230704.csv
--> finetuned_results_fp: /srv/scratch/z5313567/thesis/wav2vec2/finetuned_result/AusKidTalk/finetuned_result_AusKidTalk_20230704.csv
--> pretrained_mod: /srv/scratch/z5313567/thesis/wav2vec2/model/OGI_American/finetune_full_20230704_3
--> pretrained_tokenizer: facebook/wav2vec2-base-960h

------> PREPARING DATASET... ------------------------------------

  0%|          | 0/2 [00:00<?, ?it/s]100%|██████████| 2/2 [00:00<00:00, 404.64it/s]
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-279fdbce769aa144.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-0578383f1d122dd0.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-29045d3ca7bf2b40_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-ab704ac650a83e78_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-b5e726dfc3361620_*_of_00004.arrow
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-17049cdb3dfb7f32_*_of_00004.arrow
/srv/scratch/z5313567/thesis/wav2vec2/code/eval_AusKidTalk.py:573: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  wer_metric = load_metric("wer")
/home/z5313567/.local/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py:1643: FutureWarning: The method `freeze_feature_extractor` is deprecated and will be removed in Transformers v5.Please use the equivalent `freeze_feature_encoder` method instead.
  warnings.warn(
Loading cached processed dataset at /srv/scratch/chacmod/.cache/huggingface/datasets/baseline-960h-eval/eval_on_AusKidTalk/csv/default-886fd4d6a2dd79f4/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1/cache-5768b936075cce90.arrow
--> dataset...
DatasetDict({
    train: Dataset({
        features: ['filepath', 'transcription_clean'],
        num_rows: 3643
    })
    test: Dataset({
        features: ['filepath', 'transcription_clean'],
        num_rows: 3643
    })
})
--> Printing some random samples...
                                            filepath transcription_clean
0  /srv/scratch/chacmod/auskidtalk_audio/130_task...                 ear
1  /srv/scratch/chacmod/auskidtalk_audio/172_task...                bird
2  /srv/scratch/chacmod/auskidtalk_audio/1075_tas...                foot
3  /srv/scratch/chacmod/auskidtalk_audio/135_task...                 pig
4  /srv/scratch/chacmod/auskidtalk_audio/1150_tas...               snake
SUCCESS: Prepared dataset.

------> PROCESSING TRANSCRIPTION... ---------------------------------------


------> CREATING WAV2VEC2 FEATURE EXTRACTOR... -----------------------

SUCCESS: Created feature extractor.

------> PRE-PROCESSING DATA... ----------------------------------------- 

--> Verifying data with a random sample...
Target text: FEET
Input array shape: (9120,)
Sampling rate: 16000
SUCCESS: Data ready for training and evaluation.

------> PREPARING FOR TRAINING & EVALUATION... ----------------------- 

--> Defining data collator...
SUCCESS: Data collator defined.
--> Defining evaluation metric...
SUCCESS: Defined WER evaluation metric.
--> Loading pre-trained checkpoint...
SUCCESS: Pre-trained checkpoint loaded.

------> EVALUATING MODEL... ------------------------------------------ 

Saved results to: /srv/scratch/z5313567/thesis/wav2vec2/finetuned_result/AusKidTalk/finetuned_result_AusKidTalk_20230704.csv
--> Getting fine-tuned test results...
Fine-tuned Test WER: 0.971
--> Showing some fine-tuned prediction errors...
  target_text pred_str
0       BELLY         
1         ONE      OOL
2    VEGEMITE         
3         ONE    WOOLE
4     CRICKET         
5         THE     THOW
6       ALOFT         
7       ALIEN         
8        WOOD         
9       OTHER         
--> Taking a deeper look...
<pad> <pad> <pad> <pad> <pad> <pad> <pad> <pad> <pad> <pad> <pad>

------> SUCCESSFULLY FINISHED ---------------------------------------- 

Finished: 05/07/2023 19:51:32
